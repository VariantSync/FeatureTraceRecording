<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="">&#65279;{- |
</span><span class="hs-identifier">Description</span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">Type</span><span> </span><span class="hs-keyword">class</span><span> </span><span class="hs-identifier">for</span><span> </span><span class="hs-identifier">pretty</span><span> </span><span class="hs-identifier">printing</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">AST's</span><span class="hs-operator">.</span><span>
</span><span id="line-3"></span><span class="hs-identifier">License</span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">GNU</span><span> </span><span class="hs-identifier">LGPLv3</span><span>
</span><span id="line-4"></span><span class="hs-identifier">Maintainer</span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">paul</span><span class="hs-operator">.</span><span class="hs-identifier">bittner</span><span class="hs-glyph">@</span><span class="hs-identifier">uni</span><span class="hs-glyph">-</span><span class="hs-identifier">ulm</span><span class="hs-operator">.</span><span class="hs-identifier">de</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-identifier">Type</span><span> </span><span class="hs-keyword">class</span><span> </span><span class="hs-identifier">for</span><span> </span><span class="hs-identifier">pretty</span><span> </span><span class="hs-identifier">printing</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">AST's</span><span class="hs-operator">.</span><span>
</span><span id="line-7"></span><span class="hs-glyph">-</span><span class="">}
</span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">ASTPrettyPrinter</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="AST.html"><span class="hs-identifier">AST</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Grammar.html"><span class="hs-identifier">Grammar</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Util.html"><span class="hs-identifier">Util</span></a></span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-comment">-- | An ASTPrettyPrinter can pretty print ASTs of a certain grammar.</span><span>
</span><span id="line-15"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679094812"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="ASTPrettyPrinter"><span class="annot"><a href="ASTPrettyPrinter.html#ASTPrettyPrinter"><span class="hs-identifier hs-var">ASTPrettyPrinter</span></a></span></span><span> </span><span id="local-6989586621679094812"><span class="annot"><a href="#local-6989586621679094812"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-comment">{- |
  Pretty prints the given AST (last argument) to another type b (e.g., @String@).
  Parameters are:
  * the start indent (e.g., @&quot;&quot;@),
  * an indent generator that can generate an indent of a certain width within the context of printing a certain node (e.g., @(\_ i -&gt; genIndent i)@),
  * a function to lift strings to the output type b within the context of printing a certain node,
  * a function print nodes, and
  * the AST to print.
  -}</span><span>
</span><span id="line-25"></span><span>  </span><span id="local-6989586621679094810"><span id="local-6989586621679094811"><span id="prettyPrint"><span class="annot"><a href="ASTPrettyPrinter.html#prettyPrint"><span class="hs-identifier hs-type">prettyPrint</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679094811"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679094811"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094812"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094810"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679094811"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094812"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094810"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679094811"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094812"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094810"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679094811"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#AST"><span class="hs-identifier hs-type">AST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094812"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094810"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679094811"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">-- | Default implementation for pretty printing an AST to a @String@.</span><span>
</span><span id="line-28"></span><span id="local-6989586621679094807"><span id="local-6989586621679094808"><span class="annot"><a href="ASTPrettyPrinter.html#showCode"><span class="hs-identifier hs-type">showCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679094808"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Grammar.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094807"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ASTPrettyPrinter.html#ASTPrettyPrinter"><span class="hs-identifier hs-type">ASTPrettyPrinter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094807"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="AST.html#AST"><span class="hs-identifier hs-type">AST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094807"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094808"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span></span><span>
</span><span id="line-29"></span><span id="showCode"><span class="annot"><span class="annottext">showCode :: AST g a -&gt; String
</span><a href="ASTPrettyPrinter.html#showCode"><span class="hs-identifier hs-var hs-var">showCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Node g a -&gt; Int -&gt; String)
-&gt; (Node g a -&gt; String -&gt; String)
-&gt; (Node g a -&gt; String)
-&gt; AST g a
-&gt; String
forall b g a.
(Monoid b, ASTPrettyPrinter g) =&gt;
b
-&gt; (Node g a -&gt; Int -&gt; b)
-&gt; (Node g a -&gt; String -&gt; b)
-&gt; (Node g a -&gt; b)
-&gt; AST g a
-&gt; b
</span><a href="ASTPrettyPrinter.html#showCodeAs"><span class="hs-identifier hs-var">showCodeAs</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679094803"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679094803"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="Util.html#genIndent"><span class="hs-identifier hs-var">genIndent</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679094803"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679094801"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679094801"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679094801"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Node g a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">-- | Alias for 'prettyPrint'.</span><span>
</span><span id="line-32"></span><span id="local-6989586621679094817"><span id="local-6989586621679094819"><span id="local-6989586621679094820"><span class="annot"><a href="ASTPrettyPrinter.html#showCodeAs"><span class="hs-identifier hs-type">showCodeAs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679094820"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ASTPrettyPrinter.html#ASTPrettyPrinter"><span class="hs-identifier hs-type">ASTPrettyPrinter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094819"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679094820"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094819"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094817"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679094820"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094819"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094817"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679094820"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094819"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094817"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679094820"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#AST"><span class="hs-identifier hs-type">AST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094819"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094817"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679094820"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-33"></span><span id="showCodeAs"><span class="annot"><span class="annottext">showCodeAs :: b
-&gt; (Node g a -&gt; Int -&gt; b)
-&gt; (Node g a -&gt; String -&gt; b)
-&gt; (Node g a -&gt; b)
-&gt; AST g a
-&gt; b
</span><a href="ASTPrettyPrinter.html#showCodeAs"><span class="hs-identifier hs-var hs-var">showCodeAs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
-&gt; (Node g a -&gt; Int -&gt; b)
-&gt; (Node g a -&gt; String -&gt; b)
-&gt; (Node g a -&gt; b)
-&gt; AST g a
-&gt; b
forall g b a.
(ASTPrettyPrinter g, Monoid b) =&gt;
b
-&gt; (Node g a -&gt; Int -&gt; b)
-&gt; (Node g a -&gt; String -&gt; b)
-&gt; (Node g a -&gt; b)
-&gt; AST g a
-&gt; b
</span><a href="ASTPrettyPrinter.html#prettyPrint"><span class="hs-identifier hs-var">prettyPrint</span></a></span></pre></body></html>