<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">FeatureTrace</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Feature.html"><span class="hs-identifier">Feature</span></a></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Tree.html"><span class="hs-identifier">Tree</span></a></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="AST.html"><span class="hs-identifier">AST</span></a></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Grammar.html"><span class="hs-identifier">Grammar</span></a></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Logic.html"><span class="hs-identifier">Logic</span></a></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Propositions.html"><span class="hs-identifier">Propositions</span></a></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NullPropositions.html"><span class="hs-identifier">NullPropositions</span></a></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Simplify.html"><span class="hs-identifier">Simplify</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Simplify.html#removeRedundancy"><span class="hs-identifier">removeRedundancy</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Util.html"><span class="hs-identifier">Util</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Util.html#nothingIf"><span class="hs-identifier">nothingIf</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">type</span><span> </span><span id="FeatureTrace"><span class="annot"><a href="FeatureTrace.html#FeatureTrace"><span class="hs-identifier hs-var">FeatureTrace</span></a></span></span><span> </span><span id="local-6989586621679094345"><span class="annot"><a href="#local-6989586621679094345"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679094344"><span class="annot"><a href="#local-6989586621679094344"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="AST.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094345"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094344"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Feature.html#FeatureFormula"><span class="hs-identifier hs-type">FeatureFormula</span></a></span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span id="local-6989586621679094341"><span id="local-6989586621679094342"><span class="annot"><a href="FeatureTrace.html#emptyTrace"><span class="hs-identifier hs-type">emptyTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="FeatureTrace.html#FeatureTrace"><span class="hs-identifier hs-type">FeatureTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094342"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094341"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-17"></span><span id="emptyTrace"><span class="annot"><span class="annottext">emptyTrace :: FeatureTrace g a
</span><a href="FeatureTrace.html#emptyTrace"><span class="hs-identifier hs-var hs-var">emptyTrace</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (PropositionalFormula Feature)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span id="local-6989586621679094385"><span id="local-6989586621679094386"><span class="annot"><a href="FeatureTrace.html#simplifyFeatureTrace"><span class="hs-identifier hs-type">simplifyFeatureTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Grammar.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094386"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679094385"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679094385"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="FeatureTrace.html#FeatureTrace"><span class="hs-identifier hs-type">FeatureTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094386"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094385"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#AST"><span class="hs-identifier hs-type">AST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094386"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094385"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="FeatureTrace.html#FeatureTrace"><span class="hs-identifier hs-type">FeatureTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094386"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094385"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-20"></span><span id="simplifyFeatureTrace"><span class="annot"><span class="annottext">simplifyFeatureTrace :: FeatureTrace g a -&gt; AST g a -&gt; FeatureTrace g a
</span><a href="FeatureTrace.html#simplifyFeatureTrace"><span class="hs-identifier hs-var hs-var">simplifyFeatureTrace</span></a></span></span><span> </span><span id="local-6989586621679094338"><span class="annot"><span class="annottext">f :: FeatureTrace g a
</span><a href="#local-6989586621679094338"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679094337"><span class="annot"><span class="annottext">t :: AST g a
</span><a href="#local-6989586621679094337"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679094336"><span class="annot"><span class="annottext">v :: Node g a
</span><a href="#local-6989586621679094336"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AST g a -&gt; FeatureTrace g a -&gt; FeatureTrace g a
forall g a.
(Grammar g, Show a, Eq a) =&gt;
AST g a -&gt; FeatureTrace g a -&gt; FeatureTrace g a
</span><a href="FeatureTrace.html#pc_parentpart"><span class="hs-identifier hs-var">pc_parentpart</span></a></span><span> </span><span class="annot"><span class="annottext">AST g a
</span><a href="#local-6989586621679094337"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">FeatureTrace g a
</span><a href="#local-6989586621679094338"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679094336"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FeatureTrace g a
</span><a href="#local-6989586621679094338"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679094336"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679094334"><span class="annot"><span class="annottext">p :: PropositionalFormula Feature
</span><a href="#local-6989586621679094334"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679094333"><span class="annot"><span class="annottext">f' :: PropositionalFormula Feature
</span><a href="#local-6989586621679094333"><span class="hs-identifier hs-var">f'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula Feature -&gt; Bool)
-&gt; PropositionalFormula Feature
-&gt; Maybe (PropositionalFormula Feature)
forall a. (a -&gt; Bool) -&gt; a -&gt; Maybe a
</span><a href="Util.html#nothingIf"><span class="hs-identifier hs-var">nothingIf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PropositionalFormula Feature
-&gt; PropositionalFormula Feature -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">PropositionalFormula Feature
forall a. PropositionalFormula a
</span><a href="Propositions.html#PTrue"><span class="hs-identifier hs-var">PTrue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PropositionalFormula Feature
-&gt; PropositionalFormula Feature -&gt; PropositionalFormula Feature
forall a.
(Ord a, Show a) =&gt;
PropositionalFormula a
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Simplify.html#removeRedundancy"><span class="hs-identifier hs-var">removeRedundancy</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula Feature
</span><a href="#local-6989586621679094334"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula Feature
</span><a href="#local-6989586621679094333"><span class="hs-identifier hs-var">f'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula Feature -&gt; PropositionalFormula Feature
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#simplify"><span class="hs-identifier hs-var">Propositions.simplify</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula Feature -&gt; PropositionalFormula Feature)
-&gt; Maybe (PropositionalFormula Feature)
-&gt; Maybe (PropositionalFormula Feature)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FeatureTrace g a
</span><a href="#local-6989586621679094338"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679094336"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span id="local-6989586621679094328"><span id="local-6989586621679094329"><span class="annot"><a href="FeatureTrace.html#simplifyFeatureTraceOfNodes"><span class="hs-identifier hs-type">simplifyFeatureTraceOfNodes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Grammar.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094329"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679094328"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679094328"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="FeatureTrace.html#FeatureTrace"><span class="hs-identifier hs-type">FeatureTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094329"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094328"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#AST"><span class="hs-identifier hs-type">AST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094329"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094328"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094329"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094328"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="FeatureTrace.html#FeatureTrace"><span class="hs-identifier hs-type">FeatureTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094329"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094328"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-25"></span><span id="simplifyFeatureTraceOfNodes"><span class="annot"><span class="annottext">simplifyFeatureTraceOfNodes :: FeatureTrace g a -&gt; AST g a -&gt; Set (Node g a) -&gt; FeatureTrace g a
</span><a href="FeatureTrace.html#simplifyFeatureTraceOfNodes"><span class="hs-identifier hs-var hs-var">simplifyFeatureTraceOfNodes</span></a></span></span><span> </span><span id="local-6989586621679094326"><span class="annot"><span class="annottext">f :: FeatureTrace g a
</span><a href="#local-6989586621679094326"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679094325"><span class="annot"><span class="annottext">t :: AST g a
</span><a href="#local-6989586621679094325"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679094324"><span class="annot"><span class="annottext">d :: Set (Node g a)
</span><a href="#local-6989586621679094324"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679094323"><span class="annot"><span class="annottext">v :: Node g a
</span><a href="#local-6989586621679094323"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Node g a -&gt; Set (Node g a) -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">member</span></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679094323"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Node g a)
</span><a href="#local-6989586621679094324"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FeatureTrace g a -&gt; AST g a -&gt; FeatureTrace g a
forall g a.
(Grammar g, Show a, Eq a) =&gt;
FeatureTrace g a -&gt; AST g a -&gt; FeatureTrace g a
</span><a href="FeatureTrace.html#simplifyFeatureTrace"><span class="hs-identifier hs-var">simplifyFeatureTrace</span></a></span><span> </span><span class="annot"><span class="annottext">FeatureTrace g a
</span><a href="#local-6989586621679094326"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">AST g a
</span><a href="#local-6989586621679094325"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679094323"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FeatureTrace g a
</span><a href="#local-6989586621679094326"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679094323"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">{-
Calculates the presence condition of a node (third argument) in the given tree (first argument) with the given feature traces (second argument).
-}</span><span>
</span><span id="line-30"></span><span id="local-6989586621679094320"><span id="local-6989586621679094321"><span class="annot"><a href="FeatureTrace.html#pc"><span class="hs-identifier hs-type">pc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Grammar.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094321"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679094320"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679094320"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="AST.html#AST"><span class="hs-identifier hs-type">AST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094321"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094320"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="FeatureTrace.html#FeatureTrace"><span class="hs-identifier hs-type">FeatureTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094321"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094320"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094321"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094320"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Feature.html#FeatureFormula"><span class="hs-identifier hs-type">FeatureFormula</span></a></span></span></span><span>
</span><span id="line-31"></span><span id="pc"><span class="annot"><span class="annottext">pc :: AST g a -&gt; FeatureTrace g a -&gt; FeatureTrace g a
</span><a href="FeatureTrace.html#pc"><span class="hs-identifier hs-var hs-var">pc</span></a></span></span><span> </span><span id="local-6989586621679094318"><span class="annot"><span class="annottext">root :: AST g a
</span><a href="#local-6989586621679094318"><span class="hs-identifier hs-var">root</span></a></span></span><span> </span><span id="local-6989586621679094317"><span class="annot"><span class="annottext">trace :: FeatureTrace g a
</span><a href="#local-6989586621679094317"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span id="local-6989586621679094316"><span class="annot"><span class="annottext">node :: Node g a
</span><a href="#local-6989586621679094316"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe (PropositionalFormula Feature)]
-&gt; Maybe (PropositionalFormula Feature)
forall l. Logic l =&gt; [l] -&gt; l
</span><a href="Logic.html#land"><span class="hs-identifier hs-var">land</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FeatureTrace g a
</span><a href="#local-6989586621679094317"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679094316"><span class="hs-identifier hs-var">node</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AST g a -&gt; FeatureTrace g a -&gt; FeatureTrace g a
forall g a.
(Grammar g, Show a, Eq a) =&gt;
AST g a -&gt; FeatureTrace g a -&gt; FeatureTrace g a
</span><a href="FeatureTrace.html#pc_parentpart"><span class="hs-identifier hs-var">pc_parentpart</span></a></span><span> </span><span class="annot"><span class="annottext">AST g a
</span><a href="#local-6989586621679094318"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">FeatureTrace g a
</span><a href="#local-6989586621679094317"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679094316"><span class="hs-identifier hs-var">node</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">{-
Calculates the parental part of the presence condition of a node (third argument) in the given tree (first argument) with the given feature traces (second argument).
Crashes when the given node is not in the given tree.
(This should be more helpful for debugging instead of just returning Nothing.)
-}</span><span>
</span><span id="line-38"></span><span id="local-6989586621679094399"><span id="local-6989586621679094401"><span class="annot"><a href="FeatureTrace.html#pc_parentpart"><span class="hs-identifier hs-type">pc_parentpart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Grammar.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094401"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679094399"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679094399"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="AST.html#AST"><span class="hs-identifier hs-type">AST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094401"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094399"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="FeatureTrace.html#FeatureTrace"><span class="hs-identifier hs-type">FeatureTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094401"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094399"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094401"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094399"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Feature.html#FeatureFormula"><span class="hs-identifier hs-type">FeatureFormula</span></a></span></span></span><span>
</span><span id="line-39"></span><span id="pc_parentpart"><span class="annot"><span class="annottext">pc_parentpart :: AST g a -&gt; FeatureTrace g a -&gt; FeatureTrace g a
</span><a href="FeatureTrace.html#pc_parentpart"><span class="hs-identifier hs-var hs-var">pc_parentpart</span></a></span></span><span> </span><span id="local-6989586621679094314"><span class="annot"><span class="annottext">root :: AST g a
</span><a href="#local-6989586621679094314"><span class="hs-identifier hs-var">root</span></a></span></span><span> </span><span id="local-6989586621679094313"><span class="annot"><span class="annottext">trace :: FeatureTrace g a
</span><a href="#local-6989586621679094313"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span id="local-6989586621679094312"><span class="annot"><span class="annottext">v :: Node g a
</span><a href="#local-6989586621679094312"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Node g a -&gt; NodeType
forall g a. Grammar g =&gt; Node g a -&gt; NodeType
</span><a href="AST.html#optionaltype"><span class="hs-identifier hs-var">optionaltype</span></a></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679094312"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">NodeType -&gt; NodeType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NodeType
</span><a href="Grammar.html#Mandatory"><span class="hs-identifier hs-var">Mandatory</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AST g a -&gt; AST g a -&gt; Maybe (AST g a)
forall a. Eq a =&gt; Tree a -&gt; Tree a -&gt; Maybe (Tree a)
</span><a href="Tree.html#parent"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">AST g a
</span><a href="#local-6989586621679094314"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">AST g a
</span><a href="#local-6989586621679094308"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (AST g a)
-&gt; (AST g a -&gt; Maybe (PropositionalFormula Feature))
-&gt; Maybe (PropositionalFormula Feature)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">AST g a -&gt; FeatureTrace g a -&gt; FeatureTrace g a
forall g a.
(Grammar g, Show a, Eq a) =&gt;
AST g a -&gt; FeatureTrace g a -&gt; FeatureTrace g a
</span><a href="FeatureTrace.html#pc"><span class="hs-identifier hs-var">pc</span></a></span><span> </span><span class="annot"><span class="annottext">AST g a
</span><a href="#local-6989586621679094314"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">FeatureTrace g a
</span><a href="#local-6989586621679094313"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="annot"><span class="annottext">FeatureTrace g a
-&gt; (AST g a -&gt; Node g a)
-&gt; AST g a
-&gt; Maybe (PropositionalFormula Feature)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">AST g a -&gt; Node g a
forall a. Tree a -&gt; a
</span><a href="Tree.html#element"><span class="hs-identifier hs-var">element</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe (PropositionalFormula Feature)]
-&gt; Maybe (PropositionalFormula Feature)
forall l. Logic l =&gt; [l] -&gt; l
</span><a href="Logic.html#land"><span class="hs-identifier hs-var">land</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe (PropositionalFormula Feature)]
 -&gt; Maybe (PropositionalFormula Feature))
-&gt; [Maybe (PropositionalFormula Feature)]
-&gt; Maybe (PropositionalFormula Feature)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FeatureTrace g a
</span><a href="#local-6989586621679094313"><span class="hs-identifier hs-var">trace</span></a></span><span class="annot"><span class="annottext">FeatureTrace g a
-&gt; (AST g a -&gt; Node g a)
-&gt; AST g a
-&gt; Maybe (PropositionalFormula Feature)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">AST g a -&gt; Node g a
forall a. Tree a -&gt; a
</span><a href="Tree.html#element"><span class="hs-identifier hs-var">element</span></a></span><span> </span><span class="annot"><span class="annottext">(AST g a -&gt; Maybe (PropositionalFormula Feature))
-&gt; [AST g a] -&gt; [Maybe (PropositionalFormula Feature)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AST g a -&gt; AST g a -&gt; [AST g a]
forall a g. (Eq a, Grammar g) =&gt; AST g a -&gt; AST g a -&gt; [AST g a]
</span><a href="AST.html#optionalAncestors"><span class="hs-identifier hs-var">optionalAncestors</span></a></span><span> </span><span class="annot"><span class="annottext">AST g a
</span><a href="#local-6989586621679094314"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">AST g a
</span><a href="#local-6989586621679094308"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679094308"><span class="annot"><span class="annottext">t :: AST g a
</span><a href="#local-6989586621679094308"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AST g a -&gt; Node g a -&gt; AST g a
forall a. (Eq a, Show a) =&gt; Tree a -&gt; a -&gt; Tree a
</span><a href="Tree.html#tree"><span class="hs-identifier hs-var">tree</span></a></span><span> </span><span class="annot"><span class="annottext">AST g a
</span><a href="#local-6989586621679094314"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679094312"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span id="local-6989586621679094302"><span id="local-6989586621679094303"><span class="annot"><a href="FeatureTrace.html#augmentWithTrace"><span class="hs-identifier hs-type">augmentWithTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094303"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094302"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Feature.html#FeatureFormula"><span class="hs-identifier hs-type">FeatureFormula</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#AST"><span class="hs-identifier hs-type">AST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094303"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094302"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Tree.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Feature.html#FeatureFormula"><span class="hs-identifier hs-type">FeatureFormula</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="AST.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094303"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094302"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-45"></span><span id="augmentWithTrace"><span class="annot"><span class="annottext">augmentWithTrace :: (Node g a -&gt; Maybe (PropositionalFormula Feature))
-&gt; AST g a -&gt; Tree (Maybe (PropositionalFormula Feature), Node g a)
</span><a href="FeatureTrace.html#augmentWithTrace"><span class="hs-identifier hs-var hs-var">augmentWithTrace</span></a></span></span><span> </span><span id="local-6989586621679094300"><span class="annot"><span class="annottext">f :: Node g a -&gt; Maybe (PropositionalFormula Feature)
</span><a href="#local-6989586621679094300"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Node g a -&gt; (Maybe (PropositionalFormula Feature), Node g a))
-&gt; AST g a -&gt; Tree (Maybe (PropositionalFormula Feature), Node g a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679094299"><span class="annot"><span class="annottext">n :: Node g a
</span><a href="#local-6989586621679094299"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node g a -&gt; Maybe (PropositionalFormula Feature)
</span><a href="#local-6989586621679094300"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679094299"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679094299"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span id="local-6989586621679094297"><span id="local-6989586621679094298"><span class="annot"><a href="FeatureTrace.html#prettyPrint"><span class="hs-identifier hs-type">prettyPrint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Grammar.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094298"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679094297"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Tree.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Feature.html#FeatureFormula"><span class="hs-identifier hs-type">FeatureFormula</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="AST.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094298"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094297"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span></span><span>
</span><span id="line-48"></span><span id="prettyPrint"><span class="annot"><span class="annottext">prettyPrint :: Tree (Maybe (PropositionalFormula Feature), Node g a) -&gt; Feature
</span><a href="FeatureTrace.html#prettyPrint"><span class="hs-identifier hs-var hs-var">prettyPrint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; (Feature -&gt; Feature)
-&gt; ((Maybe (PropositionalFormula Feature), Node g a) -&gt; Feature)
-&gt; Tree (Maybe (PropositionalFormula Feature), Node g a)
-&gt; Feature
forall a b.
(Show a, Monoid b) =&gt;
Int -&gt; (Feature -&gt; b) -&gt; (a -&gt; b) -&gt; Tree a -&gt; b
</span><a href="Tree.html#prettyPrint"><span class="hs-identifier hs-var">Tree.prettyPrint</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Feature -&gt; Feature
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679094292"><span class="annot"><span class="annottext">trace :: Maybe (PropositionalFormula Feature)
</span><a href="#local-6989586621679094292"><span class="hs-identifier hs-var">trace</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679094291"><span class="annot"><span class="annottext">node :: Node g a
</span><a href="#local-6989586621679094291"><span class="hs-identifier hs-var">node</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;&lt;&quot;</span></span><span class="annot"><span class="annottext">Feature -&gt; Feature -&gt; Feature
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (PropositionalFormula Feature) -&gt; Feature
forall a. Show a =&gt; Maybe a -&gt; Feature
</span><a href="NullPropositions.html#prettyPrint"><span class="hs-identifier hs-var">NullPropositions.prettyPrint</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (PropositionalFormula Feature)
</span><a href="#local-6989586621679094292"><span class="hs-identifier hs-var">trace</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Feature -&gt; Feature -&gt; Feature
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="hs-string">&quot;&gt;&quot;</span></span><span class="annot"><span class="annottext">Feature -&gt; Feature -&gt; Feature
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node g a -&gt; Feature
forall a. Show a =&gt; a -&gt; Feature
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679094291"><span class="hs-identifier hs-var">node</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span></pre></body></html>