<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="">&#65279;module Simplify (
</span><span>    </span><span class="annot"><a href="Simplify.html#removeRedundancy"><span class="hs-identifier">removeRedundancy</span></a></span><span>
</span><span id="line-3"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Logic.html"><span class="hs-identifier">Logic</span></a></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Propositions.html"><span class="hs-identifier">Propositions</span></a></span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Propositions.html#simplify"><span class="hs-identifier">simplify</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>      </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier">PropositionalFormula</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SAT.html"><span class="hs-identifier">SAT</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="SAT.html#contradicts"><span class="hs-identifier">contradicts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="SAT.html#taut"><span class="hs-identifier">taut</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-comment">{-
  This is a naive implementation for presence condition implementation as described in
    A. von Rhein, A. Grebhahn, S. Apel, N. Siegmund, D. Beyer, and T. Berger.
    Presence-Condition Simplification in Highly Configurable Systems.
    In Proceedings of the IEEE/ACM International Conference on Software Engineering (ICSE), pages 178&#8211;188.
    IEEE Computer Society, May 2015.
  As our tool is just a proof-of-concept we implemented an own naive algorithm for presence condition simplification.
  Normally, one should adopt one of the algorithms described in the paper above.
-}</span><span>
</span><span id="line-21"></span><span id="local-6989586621679094274"><span class="annot"><a href="Simplify.html#removeRedundancy"><span class="hs-identifier hs-type">removeRedundancy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679094274"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679094274"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094274"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094274"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094274"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-22"></span><span id="removeRedundancy"><span class="annot"><span class="annottext">removeRedundancy :: PropositionalFormula a
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Simplify.html#removeRedundancy"><span class="hs-identifier hs-var hs-var">removeRedundancy</span></a></span></span><span> </span><span id="local-6989586621679094265"><span class="annot"><span class="annottext">axiom :: PropositionalFormula a
</span><a href="#local-6989586621679094265"><span class="hs-identifier hs-var">axiom</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PAnd"><span class="hs-identifier hs-type">PAnd</span></a></span><span> </span><span id="local-6989586621679094263"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679094263"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; Bool
forall a. (Show a, Ord a) =&gt; PropositionalFormula a -&gt; Bool
</span><a href="SAT.html#contradicts"><span class="hs-identifier hs-var">contradicts</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; Bool) -&gt; PropositionalFormula a -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a] -&gt; PropositionalFormula a
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#PAnd"><span class="hs-identifier hs-var">PAnd</span></a></span><span> </span><span class="annot"><span class="annottext">([PropositionalFormula a] -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679094265"><span class="hs-identifier hs-var">axiom</span></a></span><span class="annot"><span class="annottext">PropositionalFormula a
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679094263"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PFalse"><span class="hs-identifier hs-var">PFalse</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-26"></span><span>        </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#simplify"><span class="hs-identifier hs-var">simplify</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-27"></span><span>        </span><span class="annot"><span class="annottext">[PropositionalFormula a] -&gt; PropositionalFormula a
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#PAnd"><span class="hs-identifier hs-var">PAnd</span></a></span><span> </span><span class="annot"><span class="annottext">([PropositionalFormula a] -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-28"></span><span>        </span><span class="annot"><span class="annottext">(PropositionalFormula a
 -&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a])
-&gt; [PropositionalFormula a]
-&gt; [PropositionalFormula a]
-&gt; [PropositionalFormula a]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679094260"><span class="annot"><span class="annottext">elementToInspect :: PropositionalFormula a
</span><a href="#local-6989586621679094260"><span class="hs-identifier hs-var">elementToInspect</span></a></span></span><span> </span><span id="local-6989586621679094259"><span class="annot"><span class="annottext">b :: [PropositionalFormula a]
</span><a href="#local-6989586621679094259"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; Bool
forall a. (Show a, Ord a) =&gt; PropositionalFormula a -&gt; Bool
</span><a href="SAT.html#taut"><span class="hs-identifier hs-var">taut</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; Bool) -&gt; PropositionalFormula a -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
forall l. Logic l =&gt; l -&gt; l -&gt; l
</span><a href="Logic.html#limplies"><span class="hs-identifier hs-var">limplies</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679094265"><span class="hs-identifier hs-var">axiom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PropositionalFormula a] -&gt; PropositionalFormula a
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#PAnd"><span class="hs-identifier hs-var">PAnd</span></a></span><span> </span><span class="annot"><span class="annottext">([PropositionalFormula a] -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679094260"><span class="hs-identifier hs-var">elementToInspect</span></a></span><span class="annot"><span class="annottext">PropositionalFormula a
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679094259"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679094259"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679094260"><span class="hs-identifier hs-var">elementToInspect</span></a></span><span class="annot"><span class="annottext">PropositionalFormula a
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679094259"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([PropositionalFormula a] -&gt; [PropositionalFormula a])
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-29"></span><span>        </span><span class="hs-comment">-- (\c -&gt; removeRedundancy (PAnd $ axiom:(delete c cs)) c) &lt;$&gt; cs</span><span>
</span><span id="line-30"></span><span>        </span><span class="annot"><span class="annottext">PropositionalFormula a
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
forall a.
(Ord a, Show a) =&gt;
PropositionalFormula a
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Simplify.html#removeRedundancy"><span class="hs-identifier hs-var">removeRedundancy</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679094265"><span class="hs-identifier hs-var">axiom</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679094263"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-31"></span><span class="annot"><a href="Simplify.html#removeRedundancy"><span class="hs-identifier hs-var">removeRedundancy</span></a></span><span> </span><span id="local-6989586621679094256"><span class="annot"><span class="annottext">axiom :: PropositionalFormula a
</span><a href="#local-6989586621679094256"><span class="hs-identifier hs-var">axiom</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679094254"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679094254"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-32"></span><span>      </span><span class="annot"><span class="annottext">PropositionalFormula a
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
forall a.
(Ord a, Show a) =&gt;
PropositionalFormula a
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Simplify.html#removeRedundancyBase"><span class="hs-identifier hs-var">removeRedundancyBase</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679094256"><span class="hs-identifier hs-var">axiom</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-comment">--   simplify $</span><span>
</span><span id="line-34"></span><span>      </span><span class="annot"><span class="annottext">[PropositionalFormula a] -&gt; PropositionalFormula a
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#POr"><span class="hs-identifier hs-var">POr</span></a></span><span> </span><span class="annot"><span class="annottext">([PropositionalFormula a] -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-35"></span><span>      </span><span class="annot"><span class="annottext">(PropositionalFormula a
 -&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a])
-&gt; [PropositionalFormula a]
-&gt; [PropositionalFormula a]
-&gt; [PropositionalFormula a]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679094252"><span class="annot"><span class="annottext">elementToInspect :: PropositionalFormula a
</span><a href="#local-6989586621679094252"><span class="hs-identifier hs-var">elementToInspect</span></a></span></span><span> </span><span id="local-6989586621679094251"><span class="annot"><span class="annottext">b :: [PropositionalFormula a]
</span><a href="#local-6989586621679094251"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; Bool
forall a. (Show a, Ord a) =&gt; PropositionalFormula a -&gt; Bool
</span><a href="SAT.html#contradicts"><span class="hs-identifier hs-var">contradicts</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; Bool) -&gt; PropositionalFormula a -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a] -&gt; PropositionalFormula a
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#PAnd"><span class="hs-identifier hs-var">PAnd</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679094252"><span class="hs-identifier hs-var">elementToInspect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679094256"><span class="hs-identifier hs-var">axiom</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679094251"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679094252"><span class="hs-identifier hs-var">elementToInspect</span></a></span><span class="annot"><span class="annottext">PropositionalFormula a
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679094251"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([PropositionalFormula a] -&gt; [PropositionalFormula a])
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-36"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PropositionalFormula a
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
forall a.
(Ord a, Show a) =&gt;
PropositionalFormula a
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Simplify.html#removeRedundancy"><span class="hs-identifier hs-var">removeRedundancy</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679094256"><span class="hs-identifier hs-var">axiom</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679094254"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-37"></span><span class="annot"><a href="Simplify.html#removeRedundancy"><span class="hs-identifier hs-var">removeRedundancy</span></a></span><span> </span><span id="local-6989586621679094250"><span class="annot"><span class="annottext">axiom :: PropositionalFormula a
</span><a href="#local-6989586621679094250"><span class="hs-identifier hs-var">axiom</span></a></span></span><span> </span><span id="local-6989586621679094249"><span class="annot"><span class="annottext">x :: PropositionalFormula a
</span><a href="#local-6989586621679094249"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679094248"><span class="annot"><span class="annottext">y :: PropositionalFormula a
</span><a href="#local-6989586621679094248"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
forall a.
(Ord a, Show a) =&gt;
PropositionalFormula a
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Simplify.html#removeRedundancyBase"><span class="hs-identifier hs-var">removeRedundancyBase</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679094250"><span class="hs-identifier hs-var">axiom</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679094249"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; Bool
forall a. (Show a, Ord a) =&gt; PropositionalFormula a -&gt; Bool
</span><a href="SAT.html#contradicts"><span class="hs-identifier hs-var">contradicts</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; Bool) -&gt; PropositionalFormula a -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a] -&gt; PropositionalFormula a
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#PAnd"><span class="hs-identifier hs-var">PAnd</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679094248"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679094250"><span class="hs-identifier hs-var">axiom</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PFalse"><span class="hs-identifier hs-var">PFalse</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679094248"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span id="local-6989586621679094247"><span class="annot"><a href="Simplify.html#removeRedundancyBase"><span class="hs-identifier hs-type">removeRedundancyBase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679094247"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679094247"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094247"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094247"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094247"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-42"></span><span id="removeRedundancyBase"><span class="annot"><span class="annottext">removeRedundancyBase :: PropositionalFormula a
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Simplify.html#removeRedundancyBase"><span class="hs-identifier hs-var hs-var">removeRedundancyBase</span></a></span></span><span> </span><span id="local-6989586621679094246"><span class="annot"><span class="annottext">axiom :: PropositionalFormula a
</span><a href="#local-6989586621679094246"><span class="hs-identifier hs-var">axiom</span></a></span></span><span> </span><span id="local-6989586621679094245"><span class="annot"><span class="annottext">x :: PropositionalFormula a
</span><a href="#local-6989586621679094245"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#simplify"><span class="hs-identifier hs-var">simplify</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; Bool
forall a. (Show a, Ord a) =&gt; PropositionalFormula a -&gt; Bool
</span><a href="SAT.html#taut"><span class="hs-identifier hs-var">taut</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; Bool) -&gt; PropositionalFormula a -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
forall l. Logic l =&gt; l -&gt; l -&gt; l
</span><a href="Logic.html#limplies"><span class="hs-identifier hs-var">limplies</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679094246"><span class="hs-identifier hs-var">axiom</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679094245"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PTrue"><span class="hs-identifier hs-var">PTrue</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679094245"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span> </span><span class="hs-comment">{-
 A further simplifcation on PAnd would be the following.
 Say we have &quot;A and (A or B)&quot;.
 This can be simplified to &quot;A&quot;.
 How to?
 For a PAnd group to become true, every single clause must be true.
 So for each clause we can assume that all the other clauses are true.
 The following did not work
 (\c -&gt; removeRedundancy (PAnd $ axiom:(delete c cs)) c) &lt;$&gt; cs
 because it lead to
             axiom = T
           formula = (&quot;A&quot; and (&quot;A&quot; and &quot;B&quot;))
simplified formula = &quot;B&quot;
 -}</span><span>
</span><span id="line-59"></span></pre></body></html>