<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Main</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">State</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="UUID.html"><span class="hs-identifier">UUID</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="UUID.html#UUID"><span class="hs-identifier">UUID</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Util.html"><span class="hs-identifier">Util</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.html#removeQuotes"><span class="hs-identifier">removeQuotes</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><a href="Util.html#genIndent"><span class="hs-identifier">genIndent</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Tree.html"><span class="hs-identifier">Tree</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Tree.html#prettyPrint"><span class="hs-identifier">prettyPrint</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="AST.html"><span class="hs-identifier">AST</span></a></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Grammar.html"><span class="hs-identifier">Grammar</span></a></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="ASTPrettyPrinter.html"><span class="hs-identifier">ASTPrettyPrinter</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Edits.html"><span class="hs-identifier">Edits</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Edits.html#edit_identity"><span class="hs-identifier">edit_identity</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Logic.html"><span class="hs-identifier">Logic</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Propositions.html"><span class="hs-identifier">Propositions</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NullPropositions.html"><span class="hs-identifier">NullPropositions</span></a></span><span> </span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="FeatureTrace.html"><span class="hs-identifier">FeatureTrace</span></a></span><span> </span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="FeatureTraceRecording.html"><span class="hs-identifier">FeatureTraceRecording</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="FeatureColour.html"><span class="hs-identifier">FeatureColour</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="FeatureColour.html#FeatureFormulaColourPalette"><span class="hs-identifier">FeatureFormulaColourPalette</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Example.html"><span class="hs-identifier">Example</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="TikzExport.html"><span class="hs-identifier">TikzExport</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="TikzExport.html#astToTikzWithTraceDefault"><span class="hs-identifier">astToTikzWithTraceDefault</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="StackPopAlice.html"><span class="hs-identifier">StackPopAlice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="StackPopAlice.html#example"><span class="hs-identifier">example</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="StackPopBob.html"><span class="hs-identifier">StackPopBob</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="StackPopBob.html#example"><span class="hs-identifier">example</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="EditPatterns.html"><span class="hs-identifier">EditPatterns</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">-- imports for Terminal printing ---------</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Prettyprint.Doc</span></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Doc</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;+&gt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">annotate</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hardline</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Pretty</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">pretty</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Terminal</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Truthtable.html"><span class="hs-identifier">Truthtable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Truthtable.html#generatetruthtablesfor"><span class="hs-identifier">generatetruthtablesfor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- | Style defining how to print 'AST's.</span><span>
</span><span id="line-34"></span><span class="hs-keyword">data</span><span> </span><span id="CodePrintStyle"><span class="annot"><a href="Main.html#CodePrintStyle"><span class="hs-identifier hs-var">CodePrintStyle</span></a></span></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="ShowAST"><span class="annot"><a href="Main.html#ShowAST"><span class="hs-identifier hs-var">ShowAST</span></a></span></span><span>  </span><span class="hs-comment">-- ^ Prints the 'AST' by showing each 'Node' in the hierarchy in an XML-like format.</span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="ShowCode"><span class="annot"><a href="Main.html#ShowCode"><span class="hs-identifier hs-var">ShowCode</span></a></span></span><span> </span><span class="hs-comment">-- ^ Prints the 'AST' as the actual source code that it represents.</span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="ShowTikz"><span class="annot"><a href="Main.html#ShowTikz"><span class="hs-identifier hs-var">ShowTikz</span></a></span></span><span> </span><span class="hs-comment">-- ^ Print the 'AST' as tikz code to use for our paper.</span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679095573"><span id="local-6989586621679095575"><span id="local-6989586621679095577"><span class="annot"><span class="annottext">Int -&gt; CodePrintStyle -&gt; ShowS
[CodePrintStyle] -&gt; ShowS
CodePrintStyle -&gt; String
(Int -&gt; CodePrintStyle -&gt; ShowS)
-&gt; (CodePrintStyle -&gt; String)
-&gt; ([CodePrintStyle] -&gt; ShowS)
-&gt; Show CodePrintStyle
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CodePrintStyle] -&gt; ShowS
$cshowList :: [CodePrintStyle] -&gt; ShowS
show :: CodePrintStyle -&gt; String
$cshow :: CodePrintStyle -&gt; String
showsPrec :: Int -&gt; CodePrintStyle -&gt; ShowS
$cshowsPrec :: Int -&gt; CodePrintStyle -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- | Format defining whether to 'FeatureTrace's or presence conditions ('pc').</span><span>
</span><span id="line-40"></span><span class="hs-keyword">data</span><span> </span><span id="TraceDisplay"><span class="annot"><a href="Main.html#TraceDisplay"><span class="hs-identifier hs-var">TraceDisplay</span></a></span></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="Trace"><span class="annot"><a href="Main.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span></span><span> </span><span class="hs-comment">-- ^ Show the feature mapping of each node (i.e., the formula a node is directly annotated with).</span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PC"><span class="annot"><a href="Main.html#PC"><span class="hs-identifier hs-var">PC</span></a></span></span><span>    </span><span class="hs-comment">-- ^ Show the presence condition of each node (i.e., the conjunction of its feature mapping with all feature mappings inherited from ancestors).</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679095564"><span id="local-6989586621679095566"><span id="local-6989586621679095568"><span class="annot"><span class="annottext">Int -&gt; TraceDisplay -&gt; ShowS
[TraceDisplay] -&gt; ShowS
TraceDisplay -&gt; String
(Int -&gt; TraceDisplay -&gt; ShowS)
-&gt; (TraceDisplay -&gt; String)
-&gt; ([TraceDisplay] -&gt; ShowS)
-&gt; Show TraceDisplay
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TraceDisplay] -&gt; ShowS
$cshowList :: [TraceDisplay] -&gt; ShowS
show :: TraceDisplay -&gt; String
$cshow :: TraceDisplay -&gt; String
showsPrec :: Int -&gt; TraceDisplay -&gt; ShowS
$cshowsPrec :: Int -&gt; TraceDisplay -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095560"><span id="local-6989586621679095562"><span class="annot"><span class="annottext">TraceDisplay -&gt; TraceDisplay -&gt; Bool
(TraceDisplay -&gt; TraceDisplay -&gt; Bool)
-&gt; (TraceDisplay -&gt; TraceDisplay -&gt; Bool) -&gt; Eq TraceDisplay
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TraceDisplay -&gt; TraceDisplay -&gt; Bool
$c/= :: TraceDisplay -&gt; TraceDisplay -&gt; Bool
== :: TraceDisplay -&gt; TraceDisplay -&gt; Bool
$c== :: TraceDisplay -&gt; TraceDisplay -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- | Style defining how to print 'FeatureTrace's.</span><span>
</span><span id="line-45"></span><span class="hs-keyword">data</span><span> </span><span id="TraceStyle"><span class="annot"><a href="Main.html#TraceStyle"><span class="hs-identifier hs-var">TraceStyle</span></a></span></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="Text"><span class="annot"><a href="Main.html#Text"><span class="hs-identifier hs-var">Text</span></a></span></span><span>   </span><span class="hs-comment">-- ^ Show feature mapping formulas as plain text.</span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Colour"><span class="annot"><a href="Main.html#Colour"><span class="hs-identifier hs-var">Colour</span></a></span></span><span> </span><span class="hs-comment">-- ^ Encode features as colours to visualize feature mappings by colouring source code.</span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="None"><span class="annot"><a href="Main.html#None"><span class="hs-identifier hs-var">None</span></a></span></span><span>   </span><span class="hs-comment">-- ^ Do not show feature traces at all.</span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679095550"><span id="local-6989586621679095552"><span id="local-6989586621679095554"><span class="annot"><span class="annottext">Int -&gt; TraceStyle -&gt; ShowS
[TraceStyle] -&gt; ShowS
TraceStyle -&gt; String
(Int -&gt; TraceStyle -&gt; ShowS)
-&gt; (TraceStyle -&gt; String)
-&gt; ([TraceStyle] -&gt; ShowS)
-&gt; Show TraceStyle
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TraceStyle] -&gt; ShowS
$cshowList :: [TraceStyle] -&gt; ShowS
show :: TraceStyle -&gt; String
$cshow :: TraceStyle -&gt; String
showsPrec :: Int -&gt; TraceStyle -&gt; ShowS
$cshowsPrec :: Int -&gt; TraceStyle -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095546"><span id="local-6989586621679095548"><span class="annot"><span class="annottext">TraceStyle -&gt; TraceStyle -&gt; Bool
(TraceStyle -&gt; TraceStyle -&gt; Bool)
-&gt; (TraceStyle -&gt; TraceStyle -&gt; Bool) -&gt; Eq TraceStyle
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TraceStyle -&gt; TraceStyle -&gt; Bool
$c/= :: TraceStyle -&gt; TraceStyle -&gt; Bool
== :: TraceStyle -&gt; TraceStyle -&gt; Bool
$c== :: TraceStyle -&gt; TraceStyle -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">{- |
Format in which code and (recorded) feature mappings should be printed to the terminal.
-}</span><span>
</span><span id="line-54"></span><span class="hs-keyword">data</span><span> </span><span id="OutputFormat"><span class="annot"><a href="Main.html#OutputFormat"><span class="hs-identifier hs-var">OutputFormat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="OutputFormat"><span class="annot"><a href="Main.html#OutputFormat"><span class="hs-identifier hs-var">OutputFormat</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-55"></span><span>    </span><span id="codeStyle"><span class="annot"><span class="annottext">OutputFormat -&gt; CodePrintStyle
</span><a href="Main.html#codeStyle"><span class="hs-identifier hs-var hs-var">codeStyle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Main.html#CodePrintStyle"><span class="hs-identifier hs-type">CodePrintStyle</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>    </span><span id="traceDisplay"><span class="annot"><span class="annottext">OutputFormat -&gt; TraceDisplay
</span><a href="Main.html#traceDisplay"><span class="hs-identifier hs-var hs-var">traceDisplay</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Main.html#TraceDisplay"><span class="hs-identifier hs-type">TraceDisplay</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>    </span><span id="traceStyle"><span class="annot"><span class="annottext">OutputFormat -&gt; TraceStyle
</span><a href="Main.html#traceStyle"><span class="hs-identifier hs-var hs-var">traceStyle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Main.html#TraceStyle"><span class="hs-identifier hs-type">TraceStyle</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>    </span><span id="withTraceLines"><span class="annot"><span class="annottext">OutputFormat -&gt; Bool
</span><a href="Main.html#withTraceLines"><span class="hs-identifier hs-var hs-var">withTraceLines</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- ^ Whether there should be vertical lines next to the shown code on the left that indicate presence condtions.</span><span>
</span><span id="line-59"></span><span class="hs-special">}</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- Some presets for output formats:</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">{- |
The perspective of the developer, who is editing code while traces are recorded in the background
This is the format used in the figures in the paper.
-}</span><span>
</span><span id="line-67"></span><span class="annot"><a href="Main.html#userFormat"><span class="hs-identifier hs-type">userFormat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Main.html#OutputFormat"><span class="hs-identifier hs-type">OutputFormat</span></a></span><span>
</span><span id="line-68"></span><span id="userFormat"><span class="annot"><span class="annottext">userFormat :: OutputFormat
</span><a href="Main.html#userFormat"><span class="hs-identifier hs-var hs-var">userFormat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutputFormat :: CodePrintStyle
-&gt; TraceDisplay -&gt; TraceStyle -&gt; Bool -&gt; OutputFormat
</span><a href="Main.html#OutputFormat"><span class="hs-identifier hs-type hs-type">OutputFormat</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><span class="annottext">codeStyle :: CodePrintStyle
</span><a href="Main.html#codeStyle"><span class="hs-identifier hs-var">codeStyle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodePrintStyle
</span><a href="Main.html#ShowCode"><span class="hs-identifier hs-var">ShowCode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><span class="annottext">traceDisplay :: TraceDisplay
</span><a href="Main.html#traceDisplay"><span class="hs-identifier hs-var">traceDisplay</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceDisplay
</span><a href="Main.html#PC"><span class="hs-identifier hs-var">PC</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><span class="annottext">traceStyle :: TraceStyle
</span><a href="Main.html#traceStyle"><span class="hs-identifier hs-var">traceStyle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceStyle
</span><a href="Main.html#Colour"><span class="hs-identifier hs-var">Colour</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><span class="annottext">withTraceLines :: Bool
</span><a href="Main.html#withTraceLines"><span class="hs-identifier hs-var">withTraceLines</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-73"></span><span class="hs-special">}</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">{- |
A variation of 'userFormat' where traces and presence conditions can be investigated seperately at the same time.
Code is coloured in the colour of its trace while presence conditions are indicated by coloured lines on the left.
-}</span><span>
</span><span id="line-79"></span><span class="annot"><a href="Main.html#userFormatDetailed"><span class="hs-identifier hs-type">userFormatDetailed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Main.html#OutputFormat"><span class="hs-identifier hs-type">OutputFormat</span></a></span><span>
</span><span id="line-80"></span><span id="userFormatDetailed"><span class="annot"><span class="annottext">userFormatDetailed :: OutputFormat
</span><a href="Main.html#userFormatDetailed"><span class="hs-identifier hs-var hs-var">userFormatDetailed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutputFormat :: CodePrintStyle
-&gt; TraceDisplay -&gt; TraceStyle -&gt; Bool -&gt; OutputFormat
</span><a href="Main.html#OutputFormat"><span class="hs-identifier hs-type hs-type">OutputFormat</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">codeStyle :: CodePrintStyle
</span><a href="Main.html#codeStyle"><span class="hs-identifier hs-var">codeStyle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodePrintStyle
</span><a href="Main.html#ShowCode"><span class="hs-identifier hs-var">ShowCode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><span class="annottext">traceDisplay :: TraceDisplay
</span><a href="Main.html#traceDisplay"><span class="hs-identifier hs-var">traceDisplay</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceDisplay
</span><a href="Main.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><span class="annottext">traceStyle :: TraceStyle
</span><a href="Main.html#traceStyle"><span class="hs-identifier hs-var">traceStyle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceStyle
</span><a href="Main.html#Colour"><span class="hs-identifier hs-var">Colour</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><span class="annottext">withTraceLines :: Bool
</span><a href="Main.html#withTraceLines"><span class="hs-identifier hs-var">withTraceLines</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-85"></span><span class="hs-special">}</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">{- |
Shows the 'AST' of the source code with 'FeatureTrace's as formulas.
-}</span><span>
</span><span id="line-90"></span><span class="annot"><a href="Main.html#astFormat"><span class="hs-identifier hs-type">astFormat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Main.html#OutputFormat"><span class="hs-identifier hs-type">OutputFormat</span></a></span><span>
</span><span id="line-91"></span><span id="astFormat"><span class="annot"><span class="annottext">astFormat :: OutputFormat
</span><a href="Main.html#astFormat"><span class="hs-identifier hs-var hs-var">astFormat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutputFormat :: CodePrintStyle
-&gt; TraceDisplay -&gt; TraceStyle -&gt; Bool -&gt; OutputFormat
</span><a href="Main.html#OutputFormat"><span class="hs-identifier hs-type hs-type">OutputFormat</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><span class="annottext">codeStyle :: CodePrintStyle
</span><a href="Main.html#codeStyle"><span class="hs-identifier hs-var">codeStyle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodePrintStyle
</span><a href="Main.html#ShowAST"><span class="hs-identifier hs-var">ShowAST</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="annottext">traceDisplay :: TraceDisplay
</span><a href="Main.html#traceDisplay"><span class="hs-identifier hs-var">traceDisplay</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceDisplay
</span><a href="Main.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><span class="annottext">traceStyle :: TraceStyle
</span><a href="Main.html#traceStyle"><span class="hs-identifier hs-var">traceStyle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceStyle
</span><a href="Main.html#Text"><span class="hs-identifier hs-var">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><span class="annottext">withTraceLines :: Bool
</span><a href="Main.html#withTraceLines"><span class="hs-identifier hs-var">withTraceLines</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-96"></span><span class="hs-special">}</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">{- |
Tikz export of 'AST' with 'FeatureTrace's.
Used for figures in the paper.
-}</span><span>
</span><span id="line-102"></span><span class="annot"><a href="Main.html#tikzFormat"><span class="hs-identifier hs-type">tikzFormat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Main.html#OutputFormat"><span class="hs-identifier hs-type">OutputFormat</span></a></span><span>
</span><span id="line-103"></span><span id="tikzFormat"><span class="annot"><span class="annottext">tikzFormat :: OutputFormat
</span><a href="Main.html#tikzFormat"><span class="hs-identifier hs-var hs-var">tikzFormat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutputFormat :: CodePrintStyle
-&gt; TraceDisplay -&gt; TraceStyle -&gt; Bool -&gt; OutputFormat
</span><a href="Main.html#OutputFormat"><span class="hs-identifier hs-type hs-type">OutputFormat</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="annottext">codeStyle :: CodePrintStyle
</span><a href="Main.html#codeStyle"><span class="hs-identifier hs-var">codeStyle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodePrintStyle
</span><a href="Main.html#ShowTikz"><span class="hs-identifier hs-var">ShowTikz</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="annottext">traceDisplay :: TraceDisplay
</span><a href="Main.html#traceDisplay"><span class="hs-identifier hs-var">traceDisplay</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceDisplay
</span><a href="Main.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="annottext">traceStyle :: TraceStyle
</span><a href="Main.html#traceStyle"><span class="hs-identifier hs-var">traceStyle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TraceStyle
</span><a href="Main.html#None"><span class="hs-identifier hs-var">None</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="annottext">withTraceLines :: Bool
</span><a href="Main.html#withTraceLines"><span class="hs-identifier hs-var">withTraceLines</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-108"></span><span class="hs-special">}</span><span>
</span><span id="line-109"></span><span>        </span><span>
</span><span id="line-110"></span><span class="hs-comment">{- |
Entry point of the demo.
The main method will run and print the output of all examples (Alice, Bob, and the edit patterns).
You can change the format of the printed source code and feature mappings by changing the @format@ parameter inside 'main'.
Additionally, you might want to look at the truthtable of the ternary logic by Sobocinski we use (by uncommenting the line @showTruthtables@).
-}</span><span>
</span><span id="line-116"></span><span class="annot"><a href="Main.html#main"><span class="hs-identifier hs-type">main</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span id="main"><span class="annot"><span class="annottext">main :: IO ()
</span><a href="Main.html#main"><span class="hs-identifier hs-var hs-var">main</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-comment">{-
    Select your OutputFormat here.
    Above, there is a list of presets you can choose from.
    -}</span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679095534"><span class="annot"><span class="annottext">format :: OutputFormat
</span><a href="#local-6989586621679095534"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutputFormat
</span><a href="Main.html#userFormat"><span class="hs-identifier hs-var">userFormat</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-keyword">do</span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><span class="annottext">OutputFormat -&gt; IO ()
</span><a href="Main.html#showExamples"><span class="hs-identifier hs-var">showExamples</span></a></span><span> </span><span class="annot"><span class="annottext">OutputFormat
</span><a href="#local-6989586621679095534"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-125"></span><span>        </span><span class="hs-comment">-- showTruthtables</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">{- |
Runs the motivating example from the paper and examples for all edit patterns with the given 'OutputFormat'.
First, runs Alice's example where she records feature traces upon editing the pop method of a class Stack in Java (Figure 1 in the paper).
Second, shows how Bob could propagate Alice's edits and recorded feature traces to his variant as envisioned in future research.
Third, shows an instance of each edit pattern from our evaluation.
-}</span><span>
</span><span id="line-133"></span><span class="annot"><a href="Main.html#showExamples"><span class="hs-identifier hs-type">showExamples</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Main.html#OutputFormat"><span class="hs-identifier hs-type">OutputFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span id="showExamples"><span class="annot"><span class="annottext">showExamples :: OutputFormat -&gt; IO ()
</span><a href="Main.html#showExamples"><span class="hs-identifier hs-var hs-var">showExamples</span></a></span></span><span> </span><span id="local-6989586621679095532"><span class="annot"><span class="annottext">format :: OutputFormat
</span><a href="#local-6989586621679095532"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LocalTerminal -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a.
(MonadIO m, MonadMask m) =&gt;
(LocalTerminal -&gt; m a) -&gt; m a
</span><span class="hs-identifier hs-var">withTerminal</span></span><span> </span><span class="annot"><span class="annottext">((LocalTerminal -&gt; IO ()) -&gt; IO ())
-&gt; (LocalTerminal -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TerminalT LocalTerminal IO () -&gt; LocalTerminal -&gt; IO ()
forall (m :: * -&gt; *) t a.
(MonadIO m, MonadMask m, Terminal t) =&gt;
TerminalT t m a -&gt; t -&gt; m a
</span><span class="hs-identifier hs-var">runTerminalT</span></span><span> </span><span class="annot"><span class="annottext">(TerminalT LocalTerminal IO () -&gt; LocalTerminal -&gt; IO ())
-&gt; TerminalT LocalTerminal IO () -&gt; LocalTerminal -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679095529"><span class="annot"><span class="annottext">run :: State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
-&gt; TerminalT LocalTerminal IO ()
</span><a href="#local-6989586621679095529"><span class="hs-identifier hs-var hs-var">run</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutputFormat
-&gt; State
     Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
-&gt; TerminalT LocalTerminal IO ()
forall (m :: * -&gt; *) g.
(MonadColorPrinter m, Grammar g, ASTPrettyPrinter g) =&gt;
OutputFormat -&gt; State Int (Example m g String) -&gt; m ()
</span><a href="Main.html#runStepwise"><span class="hs-identifier hs-var">runStepwise</span></a></span><span> </span><span class="annot"><span class="annottext">OutputFormat
</span><a href="#local-6989586621679095532"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-keyword">do</span><span>
</span><span id="line-137"></span><span>        </span><span class="annot"><span class="annottext">Doc (Attribute (TerminalT LocalTerminal IO))
-&gt; TerminalT LocalTerminal IO ()
forall (m :: * -&gt; *).
MonadMarkupPrinter m =&gt;
Doc (Attribute m) -&gt; m ()
</span><span class="hs-identifier hs-var">putDoc</span></span><span> </span><span class="annot"><span class="annottext">Doc (Attribute (TerminalT LocalTerminal IO))
forall ann. Doc ann
</span><span class="hs-identifier hs-var">hardline</span></span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; TerminalT LocalTerminal IO ()
forall (m :: * -&gt; *). MonadColorPrinter m =&gt; String -&gt; m ()
</span><a href="Main.html#headline"><span class="hs-identifier hs-var">headline</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Running Feature Trace Recording Demo&quot;</span></span><span>
</span><span id="line-139"></span><span>        </span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; TerminalT LocalTerminal IO ()
forall (m :: * -&gt; *). MonadColorPrinter m =&gt; String -&gt; m ()
</span><a href="Main.html#headline"><span class="hs-identifier hs-var">headline</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&gt;&gt;&gt; [Motivating Example] &lt;&lt;&lt;&quot;</span></span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
-&gt; TerminalT LocalTerminal IO ()
</span><a href="#local-6989586621679095529"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
forall (m :: * -&gt; *).
MonadColorPrinter m =&gt;
State Int (Example m SimpleJavaGrammar String)
</span><a href="StackPopAlice.html#example"><span class="hs-identifier hs-var">StackPopAlice.example</span></a></span><span>
</span><span id="line-142"></span><span>        </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
-&gt; TerminalT LocalTerminal IO ()
</span><a href="#local-6989586621679095529"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
forall (m :: * -&gt; *).
MonadColorPrinter m =&gt;
State Int (Example m SimpleJavaGrammar String)
</span><a href="StackPopBob.html#example"><span class="hs-identifier hs-var">StackPopBob.example</span></a></span><span>
</span><span id="line-143"></span><span>        </span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; TerminalT LocalTerminal IO ()
forall (m :: * -&gt; *). MonadColorPrinter m =&gt; String -&gt; m ()
</span><a href="Main.html#headline"><span class="hs-identifier hs-var">headline</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&gt;&gt;&gt; [Edit Patterns] &lt;&lt;&lt;&quot;</span></span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
-&gt; TerminalT LocalTerminal IO ()
</span><a href="#local-6989586621679095529"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
forall (m :: * -&gt; *).
MonadColorPrinter m =&gt;
State Int (Example m SimpleJavaGrammar String)
</span><a href="EditPatterns.html#addIfdef"><span class="hs-identifier hs-var">EditPatterns.addIfdef</span></a></span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
-&gt; TerminalT LocalTerminal IO ()
</span><a href="#local-6989586621679095529"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
forall (m :: * -&gt; *).
MonadColorPrinter m =&gt;
State Int (Example m SimpleJavaGrammar String)
</span><a href="EditPatterns.html#addIfdefWithPC"><span class="hs-identifier hs-var">EditPatterns.addIfdefWithPC</span></a></span><span>
</span><span id="line-147"></span><span>        </span><span class="hs-comment">-- We omitted AddIfdef* as it is just a repitition of the previous pattern with arbitrary contexts and code fragments.</span><span>
</span><span id="line-148"></span><span>        </span><span class="hs-comment">-- AddIfDefElse has to be reproduced using two variants.</span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-comment">-- Hence, we need two different examples here, one for the if-branch and one for the else-branch.</span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
-&gt; TerminalT LocalTerminal IO ()
</span><a href="#local-6989586621679095529"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
forall (m :: * -&gt; *).
MonadColorPrinter m =&gt;
State Int (Example m SimpleJavaGrammar String)
</span><a href="EditPatterns.html#addIfdefElse_IfBranch"><span class="hs-identifier hs-var">EditPatterns.addIfdefElse_IfBranch</span></a></span><span>
</span><span id="line-151"></span><span>        </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
-&gt; TerminalT LocalTerminal IO ()
</span><a href="#local-6989586621679095529"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
forall (m :: * -&gt; *).
MonadColorPrinter m =&gt;
State Int (Example m SimpleJavaGrammar String)
</span><a href="EditPatterns.html#addIfdefElse_ElseBranch"><span class="hs-identifier hs-var">EditPatterns.addIfdefElse_ElseBranch</span></a></span><span>
</span><span id="line-152"></span><span>        </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
-&gt; TerminalT LocalTerminal IO ()
</span><a href="#local-6989586621679095529"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
forall (m :: * -&gt; *).
MonadColorPrinter m =&gt;
State Int (Example m SimpleJavaGrammar String)
</span><a href="EditPatterns.html#addIfdefElse_IfBranchWithPC"><span class="hs-identifier hs-var">EditPatterns.addIfdefElse_IfBranchWithPC</span></a></span><span>
</span><span id="line-153"></span><span>        </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
-&gt; TerminalT LocalTerminal IO ()
</span><a href="#local-6989586621679095529"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
forall (m :: * -&gt; *).
MonadColorPrinter m =&gt;
State Int (Example m SimpleJavaGrammar String)
</span><a href="EditPatterns.html#addIfdefElse_ElseBranchWithPC"><span class="hs-identifier hs-var">EditPatterns.addIfdefElse_ElseBranchWithPC</span></a></span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
-&gt; TerminalT LocalTerminal IO ()
</span><a href="#local-6989586621679095529"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
forall (m :: * -&gt; *).
MonadColorPrinter m =&gt;
State Int (Example m SimpleJavaGrammar String)
</span><a href="EditPatterns.html#addIfdefWrapElse"><span class="hs-identifier hs-var">EditPatterns.addIfdefWrapElse</span></a></span><span>
</span><span id="line-155"></span><span>        </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
-&gt; TerminalT LocalTerminal IO ()
</span><a href="#local-6989586621679095529"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
forall (m :: * -&gt; *).
MonadColorPrinter m =&gt;
State Int (Example m SimpleJavaGrammar String)
</span><a href="EditPatterns.html#addIfdefWrapThen"><span class="hs-identifier hs-var">EditPatterns.addIfdefWrapThen</span></a></span><span>
</span><span id="line-156"></span><span>        </span><span class="hs-comment">-- Adding non-variational code (code that belongs to all clones)</span><span>
</span><span id="line-157"></span><span>        </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
-&gt; TerminalT LocalTerminal IO ()
</span><a href="#local-6989586621679095529"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
forall (m :: * -&gt; *).
MonadColorPrinter m =&gt;
State Int (Example m SimpleJavaGrammar String)
</span><a href="EditPatterns.html#addNormalCode_nonvariational"><span class="hs-identifier hs-var">EditPatterns.addNormalCode_nonvariational</span></a></span><span>
</span><span id="line-158"></span><span>        </span><span class="hs-comment">-- Adding code without any associated trace into a tree-optional scope that is already traced.</span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
-&gt; TerminalT LocalTerminal IO ()
</span><a href="#local-6989586621679095529"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
forall (m :: * -&gt; *).
MonadColorPrinter m =&gt;
State Int (Example m SimpleJavaGrammar String)
</span><a href="EditPatterns.html#addNormalCode_outerpc"><span class="hs-identifier hs-var">EditPatterns.addNormalCode_outerpc</span></a></span><span>
</span><span id="line-160"></span><span>        </span><span class="hs-comment">-- Removing code that does not have a presence condition</span><span>
</span><span id="line-161"></span><span>        </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
-&gt; TerminalT LocalTerminal IO ()
</span><a href="#local-6989586621679095529"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
forall (m :: * -&gt; *).
MonadColorPrinter m =&gt;
State Int (Example m SimpleJavaGrammar String)
</span><a href="EditPatterns.html#remNormalCode_null"><span class="hs-identifier hs-var">EditPatterns.remNormalCode_null</span></a></span><span>
</span><span id="line-162"></span><span>        </span><span class="hs-comment">-- Removing code that has a feature trace and thereby a presence condition</span><span>
</span><span id="line-163"></span><span>        </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
-&gt; TerminalT LocalTerminal IO ()
</span><a href="#local-6989586621679095529"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
forall (m :: * -&gt; *).
MonadColorPrinter m =&gt;
State Int (Example m SimpleJavaGrammar String)
</span><a href="EditPatterns.html#remNormalCode_notnull"><span class="hs-identifier hs-var">EditPatterns.remNormalCode_notnull</span></a></span><span>
</span><span id="line-164"></span><span>        </span><span class="hs-comment">-- Removing code that has a feature trace</span><span>
</span><span id="line-165"></span><span>        </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
-&gt; TerminalT LocalTerminal IO ()
</span><a href="#local-6989586621679095529"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">State
  Int (Example (TerminalT LocalTerminal IO) SimpleJavaGrammar String)
forall (m :: * -&gt; *).
MonadColorPrinter m =&gt;
State Int (Example m SimpleJavaGrammar String)
</span><a href="EditPatterns.html#remIfdef"><span class="hs-identifier hs-var">EditPatterns.remIfdef</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- | Turns the given text into a headline in the terminal.</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- We indicate headlines with a red background.</span><span>
</span><span id="line-170"></span><span id="local-6989586621679095694"><span class="annot"><a href="Main.html#headline"><span class="hs-identifier hs-type">headline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadColorPrinter</span></span><span> </span><span class="annot"><a href="#local-6989586621679095694"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679095694"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-171"></span><span id="headline"><span class="annot"><span class="annottext">headline :: String -&gt; m ()
</span><a href="Main.html#headline"><span class="hs-identifier hs-var hs-var">headline</span></a></span></span><span> </span><span id="local-6989586621679095512"><span class="annot"><span class="annottext">text :: String
</span><a href="#local-6989586621679095512"><span class="hs-identifier hs-var">text</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc (Attribute m) -&gt; m ()
forall (m :: * -&gt; *).
MonadMarkupPrinter m =&gt;
Doc (Attribute m) -&gt; m ()
</span><span class="hs-identifier hs-var">putDoc</span></span><span> </span><span class="annot"><span class="annottext">(Doc (Attribute m) -&gt; m ()) -&gt; Doc (Attribute m) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc (Attribute m)
forall ann. Doc ann
</span><span class="hs-identifier hs-var">hardline</span></span><span> </span><span class="annot"><span class="annottext">Doc (Attribute m) -&gt; Doc (Attribute m) -&gt; Doc (Attribute m)
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attribute m -&gt; Doc (Attribute m) -&gt; Doc (Attribute m)
forall ann. ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">annotate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color m -&gt; Attribute m
forall (m :: * -&gt; *). MonadColorPrinter m =&gt; Color m -&gt; Attribute m
</span><span class="hs-identifier hs-var">background</span></span><span> </span><span class="annot"><span class="annottext">Color m
forall (m :: * -&gt; *). MonadColorPrinter m =&gt; Color m
</span><span class="hs-identifier hs-var">red</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Doc (Attribute m) -&gt; Doc (Attribute m))
-&gt; Doc (Attribute m) -&gt; Doc (Attribute m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc (Attribute m)
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679095512"><span class="hs-identifier hs-var">text</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc (Attribute m) -&gt; Doc (Attribute m) -&gt; Doc (Attribute m)
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc (Attribute m)
forall ann. Doc ann
</span><span class="hs-identifier hs-var">hardline</span></span><span> </span><span class="annot"><span class="annottext">Doc (Attribute m) -&gt; Doc (Attribute m) -&gt; Doc (Attribute m)
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc (Attribute m)
forall ann. Doc ann
</span><span class="hs-identifier hs-var">hardline</span></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | Runs the given 'Example' in the given 'OutputFormat' step by step (i.e., showing all intermediate results).</span><span>
</span><span id="line-174"></span><span id="local-6989586621679095702"><span id="local-6989586621679095704"><span class="annot"><a href="Main.html#runStepwise"><span class="hs-identifier hs-type">runStepwise</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadColorPrinter</span></span><span> </span><span class="annot"><a href="#local-6989586621679095704"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Grammar.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095702"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ASTPrettyPrinter.html#ASTPrettyPrinter"><span class="hs-identifier hs-type">ASTPrettyPrinter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095702"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Main.html#OutputFormat"><span class="hs-identifier hs-type">OutputFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="UUID.html#UUID"><span class="hs-identifier hs-type">UUID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Example.html#Example"><span class="hs-identifier hs-type">Example</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095704"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095702"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679095704"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-175"></span><span id="runStepwise"><span class="annot"><span class="annottext">runStepwise :: OutputFormat -&gt; State Int (Example m g String) -&gt; m ()
</span><a href="Main.html#runStepwise"><span class="hs-identifier hs-var hs-var">runStepwise</span></a></span></span><span> </span><span id="local-6989586621679095509"><span class="annot"><span class="annottext">format :: OutputFormat
</span><a href="#local-6989586621679095509"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span id="local-6989586621679095508"><span class="annot"><span class="annottext">ex :: State Int (Example m g String)
</span><a href="#local-6989586621679095508"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679095507"><span class="annot"><span class="annottext">example :: Example m g String
</span><a href="#local-6989586621679095507"><span class="hs-identifier hs-var hs-var">example</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State Int (Example m g String) -&gt; Example m g String
forall (m :: * -&gt; *) g a.
State Int (Example m g a) -&gt; Example m g a
</span><a href="Example.html#finalizeExample"><span class="hs-identifier hs-var">finalizeExample</span></a></span><span> </span><span class="annot"><span class="annottext">State Int (Example m g String)
</span><a href="#local-6989586621679095508"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-177"></span><span>        </span><span id="local-6989586621679095505"><span class="annot"><span class="annottext">result :: Doc (Attribute m)
</span><a href="#local-6989586621679095505"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutputFormat
-&gt; Example m g String -&gt; [Version g String] -&gt; Doc (Attribute m)
forall (m :: * -&gt; *) g a.
(MonadColorPrinter m, Grammar g, ASTPrettyPrinter g, Show a,
 Eq a) =&gt;
OutputFormat -&gt; Example m g a -&gt; [Version g a] -&gt; Doc (Attribute m)
</span><a href="Main.html#printTraces"><span class="hs-identifier hs-var">printTraces</span></a></span><span> </span><span class="annot"><span class="annottext">OutputFormat
</span><a href="#local-6989586621679095509"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">Example m g String
</span><a href="#local-6989586621679095507"><span class="hs-identifier hs-var">example</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Example m g String -&gt; [Version g String]
forall g a (m :: * -&gt; *).
(Grammar g, Show a, Eq a) =&gt;
Example m g a -&gt; [Version g a]
</span><a href="Example.html#runExampleWithDefaultFTR"><span class="hs-identifier hs-var">Example.runExampleWithDefaultFTR</span></a></span><span> </span><span class="annot"><span class="annottext">Example m g String
</span><a href="#local-6989586621679095507"><span class="hs-identifier hs-var">example</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc (Attribute m) -&gt; m ()
forall (m :: * -&gt; *).
MonadMarkupPrinter m =&gt;
Doc (Attribute m) -&gt; m ()
</span><span class="hs-identifier hs-var">putDoc</span></span><span> </span><span class="annot"><span class="annottext">(Doc (Attribute m) -&gt; m ()) -&gt; Doc (Attribute m) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc (Attribute m)
</span><a href="#local-6989586621679095505"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">Doc (Attribute m) -&gt; Doc (Attribute m) -&gt; Doc (Attribute m)
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc (Attribute m)
forall ann. Doc ann
</span><span class="hs-identifier hs-var">hardline</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m () -&gt; m () -&gt; m ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">m ()
forall (m :: * -&gt; *). MonadPrinter m =&gt; m ()
</span><span class="hs-identifier hs-var">flush</span></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">-- | Prints the given 'AST' with the given 'FeatureTrace's in the given 'OutputFormat'.</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- If the 'OutputFormat' mandates to visualize feature mappings as colours (see 'TraceStyle'),</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- the given 'FeatureFormulaColourPalette' will be used to assign colours to feature formulas.</span><span>
</span><span id="line-183"></span><span id="local-6989586621679095610"><span id="local-6989586621679095611"><span id="local-6989586621679095612"><span class="annot"><a href="Main.html#printASTWithTrace"><span class="hs-identifier hs-type">printASTWithTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadColorPrinter</span></span><span> </span><span class="annot"><a href="#local-6989586621679095612"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Grammar.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095611"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ASTPrettyPrinter.html#ASTPrettyPrinter"><span class="hs-identifier hs-type">ASTPrettyPrinter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095611"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679095610"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679095610"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-184"></span><span>    </span><span class="annot"><a href="Main.html#OutputFormat"><span class="hs-identifier hs-type">OutputFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="FeatureColour.html#FeatureFormulaColourPalette"><span class="hs-identifier hs-type">FeatureFormulaColourPalette</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095612"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#AST"><span class="hs-identifier hs-type">AST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095611"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095610"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="FeatureTrace.html#FeatureTrace"><span class="hs-identifier hs-type">FeatureTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095611"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095610"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span> </span><span class="annot"><a href="#local-6989586621679095612"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-185"></span><span id="printASTWithTrace"><span class="annot"><span class="annottext">printASTWithTrace :: OutputFormat
-&gt; FeatureFormulaColourPalette m
-&gt; AST g a
-&gt; FeatureTrace g a
-&gt; Doc (Attribute m)
</span><a href="Main.html#printASTWithTrace"><span class="hs-identifier hs-var hs-var">printASTWithTrace</span></a></span></span><span> </span><span id="local-6989586621679095500"><span class="annot"><span class="annottext">format :: OutputFormat
</span><a href="#local-6989586621679095500"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span id="local-6989586621679095499"><span class="annot"><span class="annottext">featureColourPalette :: FeatureFormulaColourPalette m
</span><a href="#local-6989586621679095499"><span class="hs-identifier hs-var">featureColourPalette</span></a></span></span><span> </span><span id="local-6989586621679095498"><span class="annot"><span class="annottext">tree :: AST g a
</span><a href="#local-6989586621679095498"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span id="local-6989586621679095497"><span class="annot"><span class="annottext">trace :: FeatureTrace g a
</span><a href="#local-6989586621679095497"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span>
</span><span id="line-187"></span><span>        </span><span id="local-6989586621679095496"><span class="annot"><span class="annottext">codestyle :: CodePrintStyle
</span><a href="#local-6989586621679095496"><span class="hs-identifier hs-var hs-var">codestyle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutputFormat -&gt; CodePrintStyle
</span><a href="Main.html#codeStyle"><span class="hs-identifier hs-var hs-var">codeStyle</span></a></span><span> </span><span class="annot"><span class="annottext">OutputFormat
</span><a href="#local-6989586621679095500"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-188"></span><span>        </span><span id="local-6989586621679095495"><span class="annot"><span class="annottext">tracestyle :: TraceStyle
</span><a href="#local-6989586621679095495"><span class="hs-identifier hs-var hs-var">tracestyle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutputFormat -&gt; TraceStyle
</span><a href="Main.html#traceStyle"><span class="hs-identifier hs-var hs-var">traceStyle</span></a></span><span> </span><span class="annot"><span class="annottext">OutputFormat
</span><a href="#local-6989586621679095500"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-189"></span><span>        </span><span id="local-6989586621679095494"><span class="annot"><span class="annottext">tracedisplay :: TraceDisplay
</span><a href="#local-6989586621679095494"><span class="hs-identifier hs-var hs-var">tracedisplay</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutputFormat -&gt; TraceDisplay
</span><a href="Main.html#traceDisplay"><span class="hs-identifier hs-var hs-var">traceDisplay</span></a></span><span> </span><span class="annot"><span class="annottext">OutputFormat
</span><a href="#local-6989586621679095500"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-190"></span><span>        </span><span id="local-6989586621679095493"><span class="annot"><span class="annottext">withtracelines :: Bool
</span><a href="#local-6989586621679095493"><span class="hs-identifier hs-var hs-var">withtracelines</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutputFormat -&gt; Bool
</span><a href="Main.html#withTraceLines"><span class="hs-identifier hs-var hs-var">withTraceLines</span></a></span><span> </span><span class="annot"><span class="annottext">OutputFormat
</span><a href="#local-6989586621679095500"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-191"></span><span>        </span><span id="local-6989586621679095492"><span class="annot"><span class="annottext">nodePrint :: (Node g a -&gt; FeatureFormula) -&gt; Node g a -&gt; Doc (Attribute m)
</span><a href="#local-6989586621679095492"><span class="hs-identifier hs-var hs-var">nodePrint</span></a></span></span><span> </span><span id="local-6989586621679095491"><span class="annot"><span class="annottext">trace :: Node g a -&gt; FeatureFormula
</span><a href="#local-6989586621679095491"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span id="local-6989586621679095490"><span class="annot"><span class="annottext">n :: Node g a
</span><a href="#local-6989586621679095490"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TraceStyle
</span><a href="#local-6989586621679095495"><span class="hs-identifier hs-var">tracestyle</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-192"></span><span>                        </span><span class="annot"><a href="Main.html#None"><span class="hs-identifier hs-type">None</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc (Attribute m)
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span class="annot"><span class="annottext">(String -&gt; Doc (Attribute m))
-&gt; (a -&gt; String) -&gt; a -&gt; Doc (Attribute m)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">ShowS
</span><a href="Util.html#removeQuotes"><span class="hs-identifier hs-var">removeQuotes</span></a></span><span class="annot"><span class="annottext">ShowS -&gt; (a -&gt; String) -&gt; a -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Doc (Attribute m)) -&gt; a -&gt; Doc (Attribute m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Node g a -&gt; a
forall g a. Node g a -&gt; a
</span><a href="AST.html#value"><span class="hs-identifier hs-var hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679095490"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-193"></span><span>                        </span><span class="annot"><a href="Main.html#Colour"><span class="hs-identifier hs-type">Colour</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FeatureFormula -&gt; String -&gt; Doc (Attribute m)
forall a. Pretty a =&gt; FeatureFormula -&gt; a -&gt; Doc (Attribute m)
</span><a href="#local-6989586621679095486"><span class="hs-identifier hs-var">paint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node g a -&gt; FeatureFormula
</span><a href="#local-6989586621679095491"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679095490"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc (Attribute m)) -&gt; String -&gt; Doc (Attribute m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Util.html#removeQuotes"><span class="hs-identifier hs-var">removeQuotes</span></a></span><span class="annot"><span class="annottext">ShowS -&gt; (a -&gt; String) -&gt; a -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; String) -&gt; a -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Node g a -&gt; a
forall g a. Node g a -&gt; a
</span><a href="AST.html#value"><span class="hs-identifier hs-var hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679095490"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-194"></span><span>                        </span><span class="annot"><a href="Main.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc (Attribute m)
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc (Attribute m)) -&gt; String -&gt; Doc (Attribute m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;&lt;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FeatureFormula -&gt; String
forall a. Show a =&gt; Maybe a -&gt; String
</span><a href="NullPropositions.html#prettyPrint"><span class="hs-identifier hs-var">NullPropositions.prettyPrint</span></a></span><span> </span><span class="annot"><span class="annottext">(FeatureFormula -&gt; String) -&gt; FeatureFormula -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Node g a -&gt; FeatureFormula
</span><a href="#local-6989586621679095491"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679095490"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;&gt;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Util.html#removeQuotes"><span class="hs-identifier hs-var">removeQuotes</span></a></span><span class="annot"><span class="annottext">ShowS -&gt; (a -&gt; String) -&gt; a -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; String) -&gt; a -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Node g a -&gt; a
forall g a. Node g a -&gt; a
</span><a href="AST.html#value"><span class="hs-identifier hs-var hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679095490"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-195"></span><span>        </span><span id="local-6989586621679095483"><span class="annot"><span class="annottext">stringPrint :: (t -&gt; FeatureFormula) -&gt; t -&gt; a -&gt; Doc (Attribute m)
</span><a href="#local-6989586621679095483"><span class="hs-identifier hs-var hs-var">stringPrint</span></a></span></span><span> </span><span id="local-6989586621679095482"><span class="annot"><span class="annottext">trace :: t -&gt; FeatureFormula
</span><a href="#local-6989586621679095482"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span id="local-6989586621679095481"><span class="annot"><span class="annottext">n :: t
</span><a href="#local-6989586621679095481"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679095480"><span class="annot"><span class="annottext">s :: a
</span><a href="#local-6989586621679095480"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TraceStyle
</span><a href="#local-6989586621679095495"><span class="hs-identifier hs-var">tracestyle</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-196"></span><span>                        </span><span class="annot"><a href="Main.html#Colour"><span class="hs-identifier hs-type">Colour</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FeatureFormula -&gt; a -&gt; Doc (Attribute m)
forall a. Pretty a =&gt; FeatureFormula -&gt; a -&gt; Doc (Attribute m)
</span><a href="#local-6989586621679095486"><span class="hs-identifier hs-var">paint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; FeatureFormula
</span><a href="#local-6989586621679095482"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679095481"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679095480"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-197"></span><span>                        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Doc (Attribute m)
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679095480"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-198"></span><span>        </span><span id="local-6989586621679095479"><span class="annot"><span class="annottext">indentGenerator :: (Node g a -&gt; FeatureFormula)
-&gt; Node g a -&gt; Int -&gt; Doc (Attribute m)
</span><a href="#local-6989586621679095479"><span class="hs-identifier hs-var hs-var">indentGenerator</span></a></span></span><span> </span><span id="local-6989586621679095478"><span class="annot"><span class="annottext">trace :: Node g a -&gt; FeatureFormula
</span><a href="#local-6989586621679095478"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span id="local-6989586621679095477"><span class="annot"><span class="annottext">n :: Node g a
</span><a href="#local-6989586621679095477"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679095476"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679095476"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TraceStyle
</span><a href="#local-6989586621679095495"><span class="hs-identifier hs-var">tracestyle</span></a></span><span> </span><span class="annot"><span class="annottext">TraceStyle -&gt; TraceStyle -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TraceStyle
</span><a href="Main.html#Colour"><span class="hs-identifier hs-var">Colour</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">TraceDisplay
</span><a href="#local-6989586621679095494"><span class="hs-identifier hs-var">tracedisplay</span></a></span><span> </span><span class="annot"><span class="annottext">TraceDisplay -&gt; TraceDisplay -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TraceDisplay
</span><a href="Main.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679095493"><span class="hs-identifier hs-var">withtracelines</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Node g a -&gt; NodeType
forall g a. Grammar g =&gt; Node g a -&gt; NodeType
</span><a href="AST.html#optionaltype"><span class="hs-identifier hs-var">optionaltype</span></a></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679095477"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">NodeType -&gt; NodeType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NodeType
</span><a href="Grammar.html#Optional"><span class="hs-identifier hs-var">Optional</span></a></span><span>
</span><span id="line-199"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Doc (Attribute m) -&gt; Doc (Attribute m) -&gt; Doc (Attribute m)
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FeatureFormula -&gt; String -&gt; Doc (Attribute m)
forall a. Pretty a =&gt; FeatureFormula -&gt; a -&gt; Doc (Attribute m)
</span><a href="#local-6989586621679095486"><span class="hs-identifier hs-var">paint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node g a -&gt; FeatureFormula
</span><a href="#local-6989586621679095478"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679095477"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-string">&quot;|&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Doc (Attribute m)
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc (Attribute m)) -&gt; String -&gt; Doc (Attribute m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="Util.html#genIndent"><span class="hs-identifier hs-var">genIndent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679095476"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc (Attribute m)
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc (Attribute m)) -&gt; String -&gt; Doc (Attribute m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="Util.html#genIndent"><span class="hs-identifier hs-var">genIndent</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679095476"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-201"></span><span>        </span><span id="local-6989586621679095486"><span class="annot"><span class="annottext">paint :: FeatureFormula -&gt; a -&gt; Doc (Attribute m)
</span><a href="#local-6989586621679095486"><span class="hs-identifier hs-var hs-var">paint</span></a></span></span><span> </span><span id="local-6989586621679095472"><span class="annot"><span class="annottext">formula :: FeatureFormula
</span><a href="#local-6989586621679095472"><span class="hs-identifier hs-var">formula</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attribute m -&gt; Doc (Attribute m) -&gt; Doc (Attribute m)
forall ann. ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">annotate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color m -&gt; Attribute m
forall (m :: * -&gt; *). MonadColorPrinter m =&gt; Color m -&gt; Attribute m
</span><span class="hs-identifier hs-var">foreground</span></span><span> </span><span class="annot"><span class="annottext">(Color m -&gt; Attribute m) -&gt; Color m -&gt; Attribute m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FeatureFormulaColourPalette m
</span><a href="#local-6989586621679095499"><span class="hs-identifier hs-var">featureColourPalette</span></a></span><span> </span><span class="annot"><span class="annottext">FeatureFormula
</span><a href="#local-6989586621679095472"><span class="hs-identifier hs-var">formula</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Doc (Attribute m) -&gt; Doc (Attribute m))
-&gt; (a -&gt; Doc (Attribute m)) -&gt; a -&gt; Doc (Attribute m)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">a -&gt; Doc (Attribute m)
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span>
</span><span id="line-202"></span><span>        </span><span class="hs-keyword">in</span><span>
</span><span id="line-203"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CodePrintStyle
</span><a href="#local-6989586621679095496"><span class="hs-identifier hs-var">codestyle</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-204"></span><span>            </span><span class="annot"><a href="Main.html#ShowAST"><span class="hs-identifier hs-type">ShowAST</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TraceStyle
</span><a href="#local-6989586621679095495"><span class="hs-identifier hs-var">tracestyle</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-205"></span><span>                </span><span class="annot"><a href="Main.html#None"><span class="hs-identifier hs-type">None</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc (Attribute m)
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span class="annot"><span class="annottext">(String -&gt; Doc (Attribute m))
-&gt; (AST g a -&gt; String) -&gt; AST g a -&gt; Doc (Attribute m)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">AST g a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-206"></span><span>                </span><span class="annot"><a href="Main.html#Colour"><span class="hs-identifier hs-type">Colour</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; (String -&gt; Doc (Attribute m))
-&gt; (Node g a -&gt; Doc (Attribute m))
-&gt; AST g a
-&gt; Doc (Attribute m)
forall a b.
(Show a, Monoid b) =&gt;
Int -&gt; (String -&gt; b) -&gt; (a -&gt; b) -&gt; Tree a -&gt; b
</span><a href="Tree.html#prettyPrint"><span class="hs-identifier hs-var">Tree.prettyPrint</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc (Attribute m)
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679095470"><span class="annot"><span class="annottext">n :: Node g a
</span><a href="#local-6989586621679095470"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FeatureFormula -&gt; String -&gt; Doc (Attribute m)
forall a. Pretty a =&gt; FeatureFormula -&gt; a -&gt; Doc (Attribute m)
</span><a href="#local-6989586621679095486"><span class="hs-identifier hs-var">paint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FeatureTrace g a
</span><a href="#local-6989586621679095497"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679095470"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc (Attribute m)) -&gt; String -&gt; Doc (Attribute m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Node g a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Node g a
</span><a href="#local-6989586621679095470"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>                </span><span class="annot"><a href="Main.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc (Attribute m)
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span class="annot"><span class="annottext">(String -&gt; Doc (Attribute m))
-&gt; (AST g a -&gt; String) -&gt; AST g a -&gt; Doc (Attribute m)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">FeatureTrace g a -&gt; AST g a -&gt; String
forall g a.
(Grammar g, Show a) =&gt;
FeatureTrace g a -&gt; AST g a -&gt; String
</span><a href="FeatureTrace.html#prettyPrint"><span class="hs-identifier hs-var">FeatureTrace.prettyPrint</span></a></span><span> </span><span class="annot"><span class="annottext">FeatureTrace g a
</span><a href="#local-6989586621679095497"><span class="hs-identifier hs-var">trace</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AST g a
</span><a href="#local-6989586621679095498"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-208"></span><span>            </span><span class="annot"><a href="Main.html#ShowTikz"><span class="hs-identifier hs-type">ShowTikz</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc (Attribute m)
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc (Attribute m)) -&gt; String -&gt; Doc (Attribute m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Version g a -&gt; String
forall a g. (Eq a, Show a, Grammar g) =&gt; Version g a -&gt; String
</span><a href="TikzExport.html#astToTikzWithTraceDefault"><span class="hs-identifier hs-var">astToTikzWithTraceDefault</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FeatureTrace g a
</span><a href="#local-6989586621679095497"><span class="hs-identifier hs-var">trace</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AST g a
</span><a href="#local-6989586621679095498"><span class="hs-identifier hs-var">tree</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>            </span><span class="annot"><a href="Main.html#ShowCode"><span class="hs-identifier hs-type">ShowCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc (Attribute m)
-&gt; (Node g a -&gt; Int -&gt; Doc (Attribute m))
-&gt; (Node g a -&gt; String -&gt; Doc (Attribute m))
-&gt; (Node g a -&gt; Doc (Attribute m))
-&gt; AST g a
-&gt; Doc (Attribute m)
forall b g a.
(Monoid b, ASTPrettyPrinter g) =&gt;
b
-&gt; (Node g a -&gt; Int -&gt; b)
-&gt; (Node g a -&gt; String -&gt; b)
-&gt; (Node g a -&gt; b)
-&gt; AST g a
-&gt; b
</span><a href="ASTPrettyPrinter.html#showCodeAs"><span class="hs-identifier hs-var">showCodeAs</span></a></span><span> </span><span class="annot"><span class="annottext">Doc (Attribute m)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FeatureTrace g a -&gt; Node g a -&gt; Int -&gt; Doc (Attribute m)
forall g a.
Grammar g =&gt;
(Node g a -&gt; FeatureFormula)
-&gt; Node g a -&gt; Int -&gt; Doc (Attribute m)
</span><a href="#local-6989586621679095479"><span class="hs-identifier hs-var">indentGenerator</span></a></span><span> </span><span class="annot"><span class="annottext">FeatureTrace g a
</span><a href="#local-6989586621679095497"><span class="hs-identifier hs-var">trace</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FeatureTrace g a -&gt; Node g a -&gt; String -&gt; Doc (Attribute m)
forall a t.
Pretty a =&gt;
(t -&gt; FeatureFormula) -&gt; t -&gt; a -&gt; Doc (Attribute m)
</span><a href="#local-6989586621679095483"><span class="hs-identifier hs-var">stringPrint</span></a></span><span> </span><span class="annot"><span class="annottext">FeatureTrace g a
</span><a href="#local-6989586621679095497"><span class="hs-identifier hs-var">trace</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FeatureTrace g a -&gt; Node g a -&gt; Doc (Attribute m)
forall a g.
Show a =&gt;
(Node g a -&gt; FeatureFormula) -&gt; Node g a -&gt; Doc (Attribute m)
</span><a href="#local-6989586621679095492"><span class="hs-identifier hs-var">nodePrint</span></a></span><span> </span><span class="annot"><span class="annottext">FeatureTrace g a
</span><a href="#local-6989586621679095497"><span class="hs-identifier hs-var">trace</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AST g a
</span><a href="#local-6989586621679095498"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">-- | Prints the given list of versions that were produced from the given example.</span><span>
</span><span id="line-212"></span><span id="local-6989586621679095676"><span id="local-6989586621679095677"><span id="local-6989586621679095678"><span class="annot"><a href="Main.html#printTraces"><span class="hs-identifier hs-type">printTraces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadColorPrinter</span></span><span> </span><span class="annot"><a href="#local-6989586621679095678"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Grammar.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095677"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ASTPrettyPrinter.html#ASTPrettyPrinter"><span class="hs-identifier hs-type">ASTPrettyPrinter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095677"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679095676"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679095676"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><a href="Main.html#OutputFormat"><span class="hs-identifier hs-type">OutputFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Example.html#Example"><span class="hs-identifier hs-type">Example</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095678"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095677"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095676"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="FeatureTraceRecording.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095677"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095676"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span> </span><span class="annot"><a href="#local-6989586621679095678"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-214"></span><span id="printTraces"><span class="annot"><span class="annottext">printTraces :: OutputFormat -&gt; Example m g a -&gt; [Version g a] -&gt; Doc (Attribute m)
</span><a href="Main.html#printTraces"><span class="hs-identifier hs-var hs-var">printTraces</span></a></span></span><span> </span><span id="local-6989586621679095467"><span class="annot"><span class="annottext">format :: OutputFormat
</span><a href="#local-6989586621679095467"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span id="local-6989586621679095466"><span class="annot"><span class="annottext">example :: Example m g a
</span><a href="#local-6989586621679095466"><span class="hs-identifier hs-var">example</span></a></span></span><span> </span><span id="local-6989586621679095465"><span class="annot"><span class="annottext">tracesAndTrees :: [Version g a]
</span><a href="#local-6989586621679095465"><span class="hs-identifier hs-var">tracesAndTrees</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-216"></span><span>        </span><span id="local-6989586621679095464"><span class="annot"><span class="annottext">featureColourPalette :: FeatureFormulaColourPalette m
</span><a href="#local-6989586621679095464"><span class="hs-identifier hs-var hs-var">featureColourPalette</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Example m g a -&gt; FeatureFormulaColourPalette m
forall (m :: * -&gt; *) g a.
Example m g a -&gt; FeatureFormulaColourPalette m
</span><a href="Example.html#colours"><span class="hs-identifier hs-var hs-var">colours</span></a></span><span> </span><span class="annot"><span class="annottext">Example m g a
</span><a href="#local-6989586621679095466"><span class="hs-identifier hs-var">example</span></a></span><span>
</span><span id="line-217"></span><span>        </span><span id="local-6989586621679095462"><span class="annot"><span class="annottext">tracedisplay :: TraceDisplay
</span><a href="#local-6989586621679095462"><span class="hs-identifier hs-var hs-var">tracedisplay</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutputFormat -&gt; TraceDisplay
</span><a href="Main.html#traceDisplay"><span class="hs-identifier hs-var hs-var">traceDisplay</span></a></span><span> </span><span class="annot"><span class="annottext">OutputFormat
</span><a href="#local-6989586621679095467"><span class="hs-identifier hs-var">format</span></a></span><span>
</span><span id="line-218"></span><span>        </span><span id="local-6989586621679095461"><span class="annot"><span class="annottext">toPC :: FeatureTrace g a -&gt; AST g a -&gt; FeatureTrace g a
</span><a href="#local-6989586621679095461"><span class="hs-identifier hs-var hs-var">toPC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679095460"><span class="annot"><span class="annottext">trace :: FeatureTrace g a
</span><a href="#local-6989586621679095460"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span id="local-6989586621679095459"><span class="annot"><span class="annottext">tree :: AST g a
</span><a href="#local-6989586621679095459"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TraceDisplay
</span><a href="#local-6989586621679095462"><span class="hs-identifier hs-var">tracedisplay</span></a></span><span> </span><span class="annot"><span class="annottext">TraceDisplay -&gt; TraceDisplay -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TraceDisplay
</span><a href="Main.html#PC"><span class="hs-identifier hs-var">PC</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">AST g a -&gt; FeatureTrace g a -&gt; FeatureTrace g a
forall g a.
(Grammar g, Show a, Eq a) =&gt;
AST g a -&gt; FeatureTrace g a -&gt; FeatureTrace g a
</span><a href="FeatureTrace.html#pc"><span class="hs-identifier hs-var">pc</span></a></span><span> </span><span class="annot"><span class="annottext">AST g a
</span><a href="#local-6989586621679095459"><span class="hs-identifier hs-var">tree</span></a></span><span> </span><span class="annot"><span class="annottext">FeatureTrace g a
</span><a href="#local-6989586621679095460"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FeatureTrace g a
</span><a href="#local-6989586621679095460"><span class="hs-identifier hs-var">trace</span></a></span><span>
</span><span id="line-219"></span><span>        </span><span class="hs-keyword">in</span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><span class="annottext">Doc (Attribute m) -&gt; Doc (Attribute m) -&gt; Doc (Attribute m)
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc (Attribute m) -&gt; Doc (Attribute m) -&gt; Doc (Attribute m)
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Doc (Attribute m)
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Doc (Attribute m) -&gt; Doc (Attribute m))
-&gt; Doc (Attribute m) -&gt; Doc (Attribute m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Attribute m -&gt; Doc (Attribute m) -&gt; Doc (Attribute m)
forall ann. ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">annotate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color m -&gt; Attribute m
forall (m :: * -&gt; *). MonadColorPrinter m =&gt; Color m -&gt; Attribute m
</span><span class="hs-identifier hs-var">background</span></span><span> </span><span class="annot"><span class="annottext">Color m
forall (m :: * -&gt; *). MonadColorPrinter m =&gt; Color m
</span><span class="hs-identifier hs-var">red</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Doc (Attribute m) -&gt; Doc (Attribute m))
-&gt; Doc (Attribute m) -&gt; Doc (Attribute m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc (Attribute m)
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc (Attribute m)) -&gt; String -&gt; Doc (Attribute m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n  &quot;</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-221"></span><span>            </span><span class="annot"><span class="hs-string">&quot;Running &quot;</span></span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Example m g a -&gt; String
forall (m :: * -&gt; *) g a. Example m g a -&gt; String
</span><a href="Example.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Example m g a
</span><a href="#local-6989586621679095466"><span class="hs-identifier hs-var">example</span></a></span><span>
</span><span id="line-222"></span><span>            </span><span class="hs-comment">-- &quot;codeStyle      = &quot;++show codestyle,</span><span>
</span><span id="line-223"></span><span>            </span><span class="hs-comment">-- &quot;traceDisplay   = &quot;++show tracedisplay,</span><span>
</span><span id="line-224"></span><span>            </span><span class="hs-comment">-- &quot;traceStyle     = &quot;++show tracestyle</span><span>
</span><span id="line-225"></span><span>            </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>        </span><span class="annot"><span class="annottext">(Doc (Attribute m) -&gt; Doc (Attribute m))
-&gt; Doc (Attribute m) -&gt; Doc (Attribute m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((((Edit g a, FeatureFormula), Version g a)
  -&gt; Doc (Attribute m) -&gt; Doc (Attribute m))
 -&gt; Doc (Attribute m)
 -&gt; [((Edit g a, FeatureFormula), Version g a)]
 -&gt; Doc (Attribute m))
-&gt; Doc (Attribute m)
-&gt; (((Edit g a, FeatureFormula), Version g a)
    -&gt; Doc (Attribute m) -&gt; Doc (Attribute m))
-&gt; [((Edit g a, FeatureFormula), Version g a)]
-&gt; Doc (Attribute m)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(((Edit g a, FeatureFormula), Version g a)
 -&gt; Doc (Attribute m) -&gt; Doc (Attribute m))
-&gt; Doc (Attribute m)
-&gt; [((Edit g a, FeatureFormula), Version g a)]
-&gt; Doc (Attribute m)
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span>
</span><span id="line-227"></span><span>            </span><span class="annot"><span class="annottext">Doc (Attribute m)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-228"></span><span>            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679095454"><span class="annot"><span class="annottext">edit :: Edit g a
</span><a href="#local-6989586621679095454"><span class="hs-identifier hs-var">edit</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095453"><span class="annot"><span class="annottext">fc :: FeatureFormula
</span><a href="#local-6989586621679095453"><span class="hs-identifier hs-var">fc</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679095452"><span class="annot"><span class="annottext">trace :: FeatureTrace g a
</span><a href="#local-6989586621679095452"><span class="hs-identifier hs-var">trace</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095451"><span class="annot"><span class="annottext">tree :: AST g a
</span><a href="#local-6989586621679095451"><span class="hs-identifier hs-var">tree</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679095450"><span class="annot"><span class="annottext">s :: Doc (Attribute m)
</span><a href="#local-6989586621679095450"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-229"></span><span>                </span><span class="annot"><span class="annottext">[Doc (Attribute m)] -&gt; Doc (Attribute m)
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-230"></span><span>                    </span><span class="annot"><span class="annottext">Doc (Attribute m)
forall ann. Doc ann
</span><span class="hs-identifier hs-var">hardline</span></span><span class="hs-special">,</span><span>
</span><span id="line-231"></span><span>                    </span><span class="annot"><span class="annottext">Doc (Attribute m)
forall ann. Doc ann
</span><span class="hs-identifier hs-var">hardline</span></span><span class="hs-special">,</span><span>
</span><span id="line-232"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; Doc (Attribute m)
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc (Attribute m)) -&gt; String -&gt; Doc (Attribute m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;==== Run &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Edit g a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Edit g a
</span><a href="#local-6989586621679095454"><span class="hs-identifier hs-var">edit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot; under context = &quot;</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-233"></span><span>                    </span><span class="annot"><span class="annottext">Attribute m -&gt; Doc (Attribute m) -&gt; Doc (Attribute m)
forall ann. ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">annotate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color m -&gt; Attribute m
forall (m :: * -&gt; *). MonadColorPrinter m =&gt; Color m -&gt; Attribute m
</span><span class="hs-identifier hs-var">foreground</span></span><span> </span><span class="annot"><span class="annottext">(Color m -&gt; Attribute m) -&gt; Color m -&gt; Attribute m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FeatureFormulaColourPalette m
</span><a href="#local-6989586621679095464"><span class="hs-identifier hs-var">featureColourPalette</span></a></span><span> </span><span class="annot"><span class="annottext">FeatureFormula
</span><a href="#local-6989586621679095453"><span class="hs-identifier hs-var">fc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Doc (Attribute m) -&gt; Doc (Attribute m))
-&gt; Doc (Attribute m) -&gt; Doc (Attribute m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc (Attribute m)
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc (Attribute m)) -&gt; String -&gt; Doc (Attribute m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FeatureFormula -&gt; String
forall a. Show a =&gt; Maybe a -&gt; String
</span><a href="NullPropositions.html#prettyPrint"><span class="hs-identifier hs-var">NullPropositions.prettyPrint</span></a></span><span> </span><span class="annot"><span class="annottext">FeatureFormula
</span><a href="#local-6989586621679095453"><span class="hs-identifier hs-var">fc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-234"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; Doc (Attribute m)
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc (Attribute m)) -&gt; String -&gt; Doc (Attribute m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot; giving us ====&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-235"></span><span>                    </span><span class="annot"><span class="annottext">Doc (Attribute m)
forall ann. Doc ann
</span><span class="hs-identifier hs-var">hardline</span></span><span class="hs-special">,</span><span>
</span><span id="line-236"></span><span>                    </span><span class="annot"><span class="annottext">OutputFormat
-&gt; FeatureFormulaColourPalette m
-&gt; AST g a
-&gt; FeatureTrace g a
-&gt; Doc (Attribute m)
forall (m :: * -&gt; *) g a.
(MonadColorPrinter m, Grammar g, ASTPrettyPrinter g, Show a,
 Eq a) =&gt;
OutputFormat
-&gt; FeatureFormulaColourPalette m
-&gt; AST g a
-&gt; FeatureTrace g a
-&gt; Doc (Attribute m)
</span><a href="Main.html#printASTWithTrace"><span class="hs-identifier hs-var">printASTWithTrace</span></a></span><span> </span><span class="annot"><span class="annottext">OutputFormat
</span><a href="#local-6989586621679095467"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">FeatureFormulaColourPalette m
</span><a href="#local-6989586621679095464"><span class="hs-identifier hs-var">featureColourPalette</span></a></span><span> </span><span class="annot"><span class="annottext">AST g a
</span><a href="#local-6989586621679095451"><span class="hs-identifier hs-var">tree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FeatureTrace g a -&gt; AST g a -&gt; FeatureTrace g a
</span><a href="#local-6989586621679095461"><span class="hs-identifier hs-var">toPC</span></a></span><span> </span><span class="annot"><span class="annottext">FeatureTrace g a
</span><a href="#local-6989586621679095452"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="annot"><span class="annottext">AST g a
</span><a href="#local-6989586621679095451"><span class="hs-identifier hs-var">tree</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-237"></span><span>                    </span><span class="annot"><span class="annottext">Doc (Attribute m)
</span><a href="#local-6989586621679095450"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>        </span><span class="annot"><span class="annottext">([((Edit g a, FeatureFormula), Version g a)] -&gt; Doc (Attribute m))
-&gt; [((Edit g a, FeatureFormula), Version g a)] -&gt; Doc (Attribute m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Edit g a, FeatureFormula)]
-&gt; [Version g a] -&gt; [((Edit g a, FeatureFormula), Version g a)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span>
</span><span id="line-239"></span><span>        </span><span class="hs-comment">-- We have to do this as the first entry in tracesAndTrees will be the initial state of the program</span><span>
</span><span id="line-240"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Edit g a, FeatureFormula)] -&gt; [(Edit g a, FeatureFormula)]
forall g a. History g a -&gt; History g a
</span><a href="Main.html#alsoShowInitialStateInHistory"><span class="hs-identifier hs-var">alsoShowInitialStateInHistory</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Example m g a -&gt; [(Edit g a, FeatureFormula)]
forall (m :: * -&gt; *) g a. Example m g a -&gt; History g a
</span><a href="Example.html#history"><span class="hs-identifier hs-var hs-var">history</span></a></span><span> </span><span class="annot"><span class="annottext">Example m g a
</span><a href="#local-6989586621679095466"><span class="hs-identifier hs-var">example</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>        </span><span class="annot"><span class="annottext">[Version g a]
</span><a href="#local-6989586621679095465"><span class="hs-identifier hs-var">tracesAndTrees</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- | Helper function to show the initial state of the given history in 'printTraces'.</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- Prepends an identity edit and dummy 'FeatureContext'.</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- The context could be anything and thus is set to 'Nothing' (/null/).</span><span>
</span><span id="line-246"></span><span id="local-6989586621679095606"><span id="local-6989586621679095607"><span class="annot"><a href="Main.html#alsoShowInitialStateInHistory"><span class="hs-identifier hs-type">alsoShowInitialStateInHistory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="FeatureTraceRecording.html#History"><span class="hs-identifier hs-type">History</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095607"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095606"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="FeatureTraceRecording.html#History"><span class="hs-identifier hs-type">History</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095607"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095606"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-247"></span><span id="alsoShowInitialStateInHistory"><span class="annot"><span class="annottext">alsoShowInitialStateInHistory :: History g a -&gt; History g a
</span><a href="Main.html#alsoShowInitialStateInHistory"><span class="hs-identifier hs-var hs-var">alsoShowInitialStateInHistory</span></a></span></span><span> </span><span id="local-6989586621679095447"><span class="annot"><span class="annottext">h :: History g a
</span><a href="#local-6989586621679095447"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Edit g a
forall g a. Edit g a
</span><a href="Edits.html#edit_identity"><span class="hs-identifier hs-var">edit_identity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FeatureFormula
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Edit g a, FeatureFormula) -&gt; History g a -&gt; History g a
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">History g a
</span><a href="#local-6989586621679095447"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-comment">-- | Helper function to help with type inference.</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- Returns all atomic values of a 'PropositionalFormula' (over strings).</span><span>
</span><span id="line-251"></span><span class="annot"><a href="Main.html#propositional_values"><span class="hs-identifier hs-type">propositional_values</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-252"></span><span id="propositional_values"><span class="annot"><span class="annottext">propositional_values :: [PropositionalFormula String]
</span><a href="Main.html#propositional_values"><span class="hs-identifier hs-var hs-var">propositional_values</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula String]
forall l. Logic l =&gt; [l]
</span><a href="Logic.html#lvalues"><span class="hs-identifier hs-var">lvalues</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- | Helper function to help with type inference.</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- Returns all atomic values of a 'NullableFormula' (over strings).</span><span>
</span><span id="line-256"></span><span class="annot"><a href="Main.html#nullableFormula_values"><span class="hs-identifier hs-type">nullableFormula_values</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="NullPropositions.html#NullableFormula"><span class="hs-identifier hs-type">NullableFormula</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-257"></span><span id="nullableFormula_values"><span class="annot"><span class="annottext">nullableFormula_values :: [FeatureFormula]
</span><a href="Main.html#nullableFormula_values"><span class="hs-identifier hs-var hs-var">nullableFormula_values</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FeatureFormula]
forall l. Logic l =&gt; [l]
</span><a href="Logic.html#lvalues"><span class="hs-identifier hs-var">lvalues</span></a></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-comment">-- | Prints truthtables for common operators in 'PropositionalFormula's and 'NullableFormulas' (not, and, or, implies, equiv)</span><span>
</span><span id="line-260"></span><span class="annot"><a href="Main.html#showTruthtables"><span class="hs-identifier hs-type">showTruthtables</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span id="showTruthtables"><span class="annot"><span class="annottext">showTruthtables :: IO ()
</span><a href="Main.html#showTruthtables"><span class="hs-identifier hs-var hs-var">showTruthtables</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LocalTerminal -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a.
(MonadIO m, MonadMask m) =&gt;
(LocalTerminal -&gt; m a) -&gt; m a
</span><span class="hs-identifier hs-var">withTerminal</span></span><span> </span><span class="annot"><span class="annottext">((LocalTerminal -&gt; IO ()) -&gt; IO ())
-&gt; (LocalTerminal -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TerminalT LocalTerminal IO () -&gt; LocalTerminal -&gt; IO ()
forall (m :: * -&gt; *) t a.
(MonadIO m, MonadMask m, Terminal t) =&gt;
TerminalT t m a -&gt; t -&gt; m a
</span><span class="hs-identifier hs-var">runTerminalT</span></span><span> </span><span class="annot"><span class="annottext">(TerminalT LocalTerminal IO () -&gt; LocalTerminal -&gt; IO ())
-&gt; TerminalT LocalTerminal IO () -&gt; LocalTerminal -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-keyword">do</span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; TerminalT LocalTerminal IO ()
forall (m :: * -&gt; *). MonadColorPrinter m =&gt; String -&gt; m ()
</span><a href="Main.html#headline"><span class="hs-identifier hs-var">headline</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Propositional Logic&quot;</span></span><span>
</span><span id="line-264"></span><span>        </span><span class="annot"><span class="annottext">Doc (Attribute (TerminalT LocalTerminal IO))
-&gt; TerminalT LocalTerminal IO ()
forall (m :: * -&gt; *).
MonadMarkupPrinter m =&gt;
Doc (Attribute m) -&gt; m ()
</span><span class="hs-identifier hs-var">putDoc</span></span><span class="annot"><span class="annottext">(Doc (Attribute (TerminalT LocalTerminal IO))
 -&gt; TerminalT LocalTerminal IO ())
-&gt; (String -&gt; Doc (Attribute (TerminalT LocalTerminal IO)))
-&gt; String
-&gt; TerminalT LocalTerminal IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">String -&gt; Doc (Attribute (TerminalT LocalTerminal IO))
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TerminalT LocalTerminal IO ())
-&gt; String -&gt; TerminalT LocalTerminal IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula String] -&gt; String
forall a. (Logic a, Show a) =&gt; [a] -&gt; String
</span><a href="Truthtable.html#generatetruthtablesfor"><span class="hs-identifier hs-var">generatetruthtablesfor</span></a></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula String]
</span><a href="Main.html#propositional_values"><span class="hs-identifier hs-var">propositional_values</span></a></span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><span class="annottext">Doc (Attribute (TerminalT LocalTerminal IO))
-&gt; TerminalT LocalTerminal IO ()
forall (m :: * -&gt; *).
MonadMarkupPrinter m =&gt;
Doc (Attribute m) -&gt; m ()
</span><span class="hs-identifier hs-var">putDoc</span></span><span> </span><span class="annot"><span class="annottext">(Doc (Attribute (TerminalT LocalTerminal IO))
 -&gt; TerminalT LocalTerminal IO ())
-&gt; Doc (Attribute (TerminalT LocalTerminal IO))
-&gt; TerminalT LocalTerminal IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc (Attribute (TerminalT LocalTerminal IO))
forall ann. Doc ann
</span><span class="hs-identifier hs-var">hardline</span></span><span> </span><span class="annot"><span class="annottext">Doc (Attribute (TerminalT LocalTerminal IO))
-&gt; Doc (Attribute (TerminalT LocalTerminal IO))
-&gt; Doc (Attribute (TerminalT LocalTerminal IO))
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc (Attribute (TerminalT LocalTerminal IO))
forall ann. Doc ann
</span><span class="hs-identifier hs-var">hardline</span></span><span>
</span><span id="line-266"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; TerminalT LocalTerminal IO ()
forall (m :: * -&gt; *). MonadColorPrinter m =&gt; String -&gt; m ()
</span><a href="Main.html#headline"><span class="hs-identifier hs-var">headline</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Ternary Logic With Null&quot;</span></span><span>
</span><span id="line-267"></span><span>        </span><span class="annot"><span class="annottext">Doc (Attribute (TerminalT LocalTerminal IO))
-&gt; TerminalT LocalTerminal IO ()
forall (m :: * -&gt; *).
MonadMarkupPrinter m =&gt;
Doc (Attribute m) -&gt; m ()
</span><span class="hs-identifier hs-var">putDoc</span></span><span class="annot"><span class="annottext">(Doc (Attribute (TerminalT LocalTerminal IO))
 -&gt; TerminalT LocalTerminal IO ())
-&gt; (String -&gt; Doc (Attribute (TerminalT LocalTerminal IO)))
-&gt; String
-&gt; TerminalT LocalTerminal IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">String -&gt; Doc (Attribute (TerminalT LocalTerminal IO))
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TerminalT LocalTerminal IO ())
-&gt; String -&gt; TerminalT LocalTerminal IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[FeatureFormula] -&gt; String
forall a. (Logic a, Show a) =&gt; [a] -&gt; String
</span><a href="Truthtable.html#generatetruthtablesfor"><span class="hs-identifier hs-var">generatetruthtablesfor</span></a></span><span> </span><span class="annot"><span class="annottext">[FeatureFormula]
</span><a href="Main.html#nullableFormula_values"><span class="hs-identifier hs-var">nullableFormula_values</span></a></span></pre></body></html>