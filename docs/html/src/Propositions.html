<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Propositions</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Logic.html"><span class="hs-identifier">Logic</span></a></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">intercalate</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">data</span><span> </span><span id="PropositionalFormula"><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-var">PropositionalFormula</span></a></span></span><span> </span><span id="local-6989586621679093246"><span class="annot"><a href="#local-6989586621679093246"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-7"></span><span>      </span><span id="PTrue"><span class="annot"><a href="Propositions.html#PTrue"><span class="hs-identifier hs-var">PTrue</span></a></span></span><span>
</span><span id="line-8"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PFalse"><span class="annot"><a href="Propositions.html#PFalse"><span class="hs-identifier hs-var">PFalse</span></a></span></span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PVariable"><span class="annot"><a href="Propositions.html#PVariable"><span class="hs-identifier hs-var">PVariable</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679093246"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PNot"><span class="annot"><a href="Propositions.html#PNot"><span class="hs-identifier hs-var">PNot</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093246"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PAnd"><span class="annot"><a href="Propositions.html#PAnd"><span class="hs-identifier hs-var">PAnd</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093246"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="POr"><span class="annot"><a href="Propositions.html#POr"><span class="hs-identifier hs-var">POr</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093246"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679093197"><span id="local-6989586621679093199"><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a -&gt; Bool
(PropositionalFormula a -&gt; PropositionalFormula a -&gt; Bool)
-&gt; (PropositionalFormula a -&gt; PropositionalFormula a -&gt; Bool)
-&gt; Eq (PropositionalFormula a)
forall a.
Eq a =&gt;
PropositionalFormula a -&gt; PropositionalFormula a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PropositionalFormula a -&gt; PropositionalFormula a -&gt; Bool
$c/= :: forall a.
Eq a =&gt;
PropositionalFormula a -&gt; PropositionalFormula a -&gt; Bool
== :: PropositionalFormula a -&gt; PropositionalFormula a -&gt; Bool
$c== :: forall a.
Eq a =&gt;
PropositionalFormula a -&gt; PropositionalFormula a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-comment">-- instance Logic (PropositionalFormula a) Bool where</span><span>
</span><span id="line-16"></span><span class="hs-comment">--     ltrue = PTrue</span><span>
</span><span id="line-17"></span><span class="hs-comment">--     lfalse = PFalse</span><span>
</span><span id="line-18"></span><span class="hs-comment">--     lvalues = [lfalse, ltrue]</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-comment">--     lnot PTrue = PFalse</span><span>
</span><span id="line-21"></span><span class="hs-comment">--     lnot PFalse = PTrue</span><span>
</span><span id="line-22"></span><span class="hs-comment">--     lnot p = PNot p</span><span>
</span><span id="line-23"></span><span>    </span><span>
</span><span id="line-24"></span><span class="hs-comment">--     land [] = PTrue</span><span>
</span><span id="line-25"></span><span class="hs-comment">--     land l = PAnd l</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">--     lor [] = PFalse</span><span>
</span><span id="line-28"></span><span class="hs-comment">--     lor l = POr l</span><span>
</span><span id="line-29"></span><span>    </span><span>
</span><span id="line-30"></span><span class="hs-comment">--     leval _ PTrue = True</span><span>
</span><span id="line-31"></span><span class="hs-comment">--     leval _ PFalse = False</span><span>
</span><span id="line-32"></span><span class="hs-comment">--     leval config (PNot x) = not $ leval config x -- This should evaluate as config should only map to lvalues and lnot directly inverts PTrue and PFalse.</span><span>
</span><span id="line-33"></span><span class="hs-comment">--     leval config (PAnd cs) = and $ fmap (leval config) cs</span><span>
</span><span id="line-34"></span><span class="hs-comment">--     leval config (POr cs) = or $ fmap (leval config) cs</span><span>
</span><span id="line-35"></span><span class="hs-comment">--     leval config v@(PVariable x) = config v</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span id="local-6989586621679093195"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679093184"><span id="local-6989586621679093186"><span id="local-6989586621679093191"><span class="annot"><a href="Logic.html#Logic"><span class="hs-identifier hs-type">Logic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093195"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-38"></span><span>    </span><span id="local-6989586621679093181"><span class="annot"><span class="annottext">ltrue :: PropositionalFormula a
</span><a href="Logic.html#ltrue"><span class="hs-identifier hs-var hs-var hs-var hs-var">ltrue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PTrue"><span class="hs-identifier hs-var">PTrue</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span id="local-6989586621679093179"><span class="annot"><span class="annottext">lfalse :: PropositionalFormula a
</span><a href="Logic.html#lfalse"><span class="hs-identifier hs-var hs-var hs-var hs-var">lfalse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PFalse"><span class="hs-identifier hs-var">PFalse</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>    </span><span id="local-6989586621679093177"><span class="annot"><span class="annottext">lnot :: PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Logic.html#lnot"><span class="hs-identifier hs-var hs-var hs-var hs-var">lnot</span></a></span></span><span> </span><span class="annot"><a href="Propositions.html#PTrue"><span class="hs-identifier hs-type">PTrue</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PFalse"><span class="hs-identifier hs-var">PFalse</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="Logic.html#lnot"><span class="hs-identifier hs-var">lnot</span></a></span><span> </span><span class="annot"><a href="Propositions.html#PFalse"><span class="hs-identifier hs-type">PFalse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PTrue"><span class="hs-identifier hs-var">PTrue</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Logic.html#lnot"><span class="hs-identifier hs-var">lnot</span></a></span><span> </span><span id="local-6989586621679093175"><span class="annot"><span class="annottext">p :: PropositionalFormula a
</span><a href="#local-6989586621679093175"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#PNot"><span class="hs-identifier hs-var">PNot</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093175"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span>
</span><span id="line-45"></span><span>    </span><span id="local-6989586621679093174"><span class="annot"><span class="annottext">land :: [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Logic.html#land"><span class="hs-identifier hs-var hs-var hs-var hs-var">land</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PTrue"><span class="hs-identifier hs-var">PTrue</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Logic.html#land"><span class="hs-identifier hs-var">land</span></a></span><span> </span><span id="local-6989586621679093172"><span class="annot"><span class="annottext">l :: [PropositionalFormula a]
</span><a href="#local-6989586621679093172"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a] -&gt; PropositionalFormula a
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#PAnd"><span class="hs-identifier hs-var">PAnd</span></a></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093172"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span>    </span><span id="local-6989586621679093171"><span class="annot"><span class="annottext">lor :: [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Logic.html#lor"><span class="hs-identifier hs-var hs-var hs-var hs-var">lor</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PFalse"><span class="hs-identifier hs-var">PFalse</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Logic.html#lor"><span class="hs-identifier hs-var">lor</span></a></span><span> </span><span id="local-6989586621679093169"><span class="annot"><span class="annottext">l :: [PropositionalFormula a]
</span><a href="#local-6989586621679093169"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a] -&gt; PropositionalFormula a
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#POr"><span class="hs-identifier hs-var">POr</span></a></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093169"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span>
</span><span id="line-51"></span><span>    </span><span id="local-6989586621679093168"><span class="annot"><span class="annottext">leval :: (PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Logic.html#leval"><span class="hs-identifier hs-var hs-var hs-var hs-var">leval</span></a></span></span><span> </span><span id="local-6989586621679093166"><span class="annot"><span class="annottext">config :: PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="#local-6989586621679093166"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PNot"><span class="hs-identifier hs-type">PNot</span></a></span><span> </span><span id="local-6989586621679093165"><span class="annot"><span class="annottext">x :: PropositionalFormula a
</span><a href="#local-6989586621679093165"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall l. Logic l =&gt; l -&gt; l
</span><a href="Logic.html#lnot"><span class="hs-identifier hs-var">lnot</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
forall l. Logic l =&gt; (l -&gt; l) -&gt; l -&gt; l
</span><a href="Logic.html#leval"><span class="hs-identifier hs-var">leval</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="#local-6989586621679093166"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093165"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-comment">-- This should evaluate as config should only map to lvalues and lnot directly inverts PTrue and PFalse.</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="Logic.html#leval"><span class="hs-identifier hs-var">leval</span></a></span><span> </span><span id="local-6989586621679093164"><span class="annot"><span class="annottext">config :: PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="#local-6989586621679093164"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PAnd"><span class="hs-identifier hs-type">PAnd</span></a></span><span> </span><span id="local-6989586621679093163"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679093163"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; PropositionalFormula a
forall a. Bool -&gt; PropositionalFormula a
</span><a href="Propositions.html#liftBool"><span class="hs-identifier hs-var">liftBool</span></a></span><span class="annot"><span class="annottext">(Bool -&gt; PropositionalFormula a)
-&gt; (Bool -&gt; Bool) -&gt; Bool -&gt; PropositionalFormula a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; PropositionalFormula a) -&gt; Bool -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; Bool)
-&gt; [PropositionalFormula a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; Bool
forall a. PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#isPFalse"><span class="hs-identifier hs-var">isPFalse</span></a></span><span> </span><span class="annot"><span class="annottext">([PropositionalFormula a] -&gt; Bool)
-&gt; [PropositionalFormula a] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
forall l. Logic l =&gt; (l -&gt; l) -&gt; l -&gt; l
</span><a href="Logic.html#leval"><span class="hs-identifier hs-var">leval</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="#local-6989586621679093164"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093163"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><a href="Logic.html#leval"><span class="hs-identifier hs-var">leval</span></a></span><span> </span><span id="local-6989586621679093157"><span class="annot"><span class="annottext">config :: PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="#local-6989586621679093157"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679093156"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679093156"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; PropositionalFormula a
forall a. Bool -&gt; PropositionalFormula a
</span><a href="Propositions.html#liftBool"><span class="hs-identifier hs-var">liftBool</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; PropositionalFormula a) -&gt; Bool -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; Bool)
-&gt; [PropositionalFormula a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; Bool
forall a. PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#isPTrue"><span class="hs-identifier hs-var">isPTrue</span></a></span><span> </span><span class="annot"><span class="annottext">([PropositionalFormula a] -&gt; Bool)
-&gt; [PropositionalFormula a] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
forall l. Logic l =&gt; (l -&gt; l) -&gt; l -&gt; l
</span><a href="Logic.html#leval"><span class="hs-identifier hs-var">leval</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="#local-6989586621679093157"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093156"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><a href="Logic.html#leval"><span class="hs-identifier hs-var">leval</span></a></span><span> </span><span id="local-6989586621679093154"><span class="annot"><span class="annottext">config :: PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="#local-6989586621679093154"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679093153"><span class="annot"><span class="annottext">p :: PropositionalFormula a
</span><a href="#local-6989586621679093153"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="#local-6989586621679093154"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093153"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679093150"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>    </span><span id="local-6989586621679093148"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; PropositionalFormula a -&gt; PropositionalFormula b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679093147"><span class="annot"><span class="annottext">f :: a -&gt; b
</span><a href="#local-6989586621679093147"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="Propositions.html#PTrue"><span class="hs-identifier hs-type">PTrue</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula b
forall a. PropositionalFormula a
</span><a href="Propositions.html#PTrue"><span class="hs-identifier hs-var">PTrue</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679093146"><span class="annot"><span class="annottext">f :: a -&gt; b
</span><a href="#local-6989586621679093146"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="Propositions.html#PFalse"><span class="hs-identifier hs-type">PFalse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula b
forall a. PropositionalFormula a
</span><a href="Propositions.html#PFalse"><span class="hs-identifier hs-var">PFalse</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679093145"><span class="annot"><span class="annottext">f :: a -&gt; b
</span><a href="#local-6989586621679093145"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PVariable"><span class="hs-identifier hs-type">PVariable</span></a></span><span> </span><span id="local-6989586621679093144"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679093144"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; PropositionalFormula b
forall a. a -&gt; PropositionalFormula a
</span><a href="Propositions.html#PVariable"><span class="hs-identifier hs-var">PVariable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679093145"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679093144"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679093143"><span class="annot"><span class="annottext">f :: a -&gt; b
</span><a href="#local-6989586621679093143"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PNot"><span class="hs-identifier hs-type">PNot</span></a></span><span> </span><span id="local-6989586621679093142"><span class="annot"><span class="annottext">p :: PropositionalFormula a
</span><a href="#local-6989586621679093142"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula b -&gt; PropositionalFormula b
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#PNot"><span class="hs-identifier hs-var">PNot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; PropositionalFormula a -&gt; PropositionalFormula b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679093143"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093142"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679093141"><span class="annot"><span class="annottext">f :: a -&gt; b
</span><a href="#local-6989586621679093141"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PAnd"><span class="hs-identifier hs-type">PAnd</span></a></span><span> </span><span id="local-6989586621679093140"><span class="annot"><span class="annottext">c :: [PropositionalFormula a]
</span><a href="#local-6989586621679093140"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula b] -&gt; PropositionalFormula b
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#PAnd"><span class="hs-identifier hs-var">PAnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula b)
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; PropositionalFormula a -&gt; PropositionalFormula b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679093141"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093140"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679093139"><span class="annot"><span class="annottext">f :: a -&gt; b
</span><a href="#local-6989586621679093139"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679093138"><span class="annot"><span class="annottext">c :: [PropositionalFormula a]
</span><a href="#local-6989586621679093138"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula b] -&gt; PropositionalFormula b
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#POr"><span class="hs-identifier hs-var">POr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula b)
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; PropositionalFormula a -&gt; PropositionalFormula b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679093139"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093138"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- Maybe this should better be implemented as a map as an Assignment always is a partial function.</span><span>
</span><span id="line-65"></span><span class="hs-keyword">type</span><span> </span><span id="Assignment"><span class="annot"><a href="Propositions.html#Assignment"><span class="hs-identifier hs-var">Assignment</span></a></span></span><span> </span><span id="local-6989586621679093137"><span class="annot"><a href="#local-6989586621679093137"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679093137"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span id="local-6989586621679093243"><span class="annot"><a href="Propositions.html#eval"><span class="hs-identifier hs-type">eval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Propositions.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093243"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093243"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-68"></span><span id="eval"><span class="annot"><span class="annottext">eval :: Assignment a -&gt; PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#eval"><span class="hs-identifier hs-var hs-var">eval</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><a href="Propositions.html#PTrue"><span class="hs-identifier hs-type">PTrue</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-69"></span><span class="annot"><a href="Propositions.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><a href="Propositions.html#PFalse"><span class="hs-identifier hs-type">PFalse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-70"></span><span class="annot"><a href="Propositions.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span id="local-6989586621679093135"><span class="annot"><span class="annottext">config :: Assignment a
</span><a href="#local-6989586621679093135"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679093134"><span class="annot"><span class="annottext">v :: PropositionalFormula a
</span><a href="#local-6989586621679093134"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PVariable"><span class="hs-identifier hs-type">PVariable</span></a></span><span> </span><span id="local-6989586621679093133"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679093133"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Assignment a
</span><a href="#local-6989586621679093135"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679093133"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-71"></span><span class="annot"><a href="Propositions.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span id="local-6989586621679093132"><span class="annot"><span class="annottext">config :: Assignment a
</span><a href="#local-6989586621679093132"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PNot"><span class="hs-identifier hs-type">PNot</span></a></span><span> </span><span id="local-6989586621679093131"><span class="annot"><span class="annottext">x :: PropositionalFormula a
</span><a href="#local-6989586621679093131"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Assignment a -&gt; PropositionalFormula a -&gt; Bool
forall a. Assignment a -&gt; PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Assignment a
</span><a href="#local-6989586621679093132"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093131"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-72"></span><span class="annot"><a href="Propositions.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span id="local-6989586621679093130"><span class="annot"><span class="annottext">config :: Assignment a
</span><a href="#local-6989586621679093130"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PAnd"><span class="hs-identifier hs-type">PAnd</span></a></span><span> </span><span id="local-6989586621679093129"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679093129"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool) -&gt; [Bool] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; Bool)
-&gt; [PropositionalFormula a] -&gt; [Bool]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Assignment a -&gt; PropositionalFormula a -&gt; Bool
forall a. Assignment a -&gt; PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Assignment a
</span><a href="#local-6989586621679093130"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093129"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-73"></span><span class="annot"><a href="Propositions.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span id="local-6989586621679093127"><span class="annot"><span class="annottext">config :: Assignment a
</span><a href="#local-6989586621679093127"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679093126"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679093126"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool) -&gt; [Bool] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; Bool)
-&gt; [PropositionalFormula a] -&gt; [Bool]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Assignment a -&gt; PropositionalFormula a -&gt; Bool
forall a. Assignment a -&gt; PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Assignment a
</span><a href="#local-6989586621679093127"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093126"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span id="local-6989586621679093262"><span class="annot"><a href="Propositions.html#liftBool"><span class="hs-identifier hs-type">liftBool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093262"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-76"></span><span id="liftBool"><span class="annot"><span class="annottext">liftBool :: Bool -&gt; PropositionalFormula a
</span><a href="Propositions.html#liftBool"><span class="hs-identifier hs-var hs-var">liftBool</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PTrue"><span class="hs-identifier hs-var">PTrue</span></a></span><span>
</span><span id="line-77"></span><span class="annot"><a href="Propositions.html#liftBool"><span class="hs-identifier hs-var">liftBool</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PFalse"><span class="hs-identifier hs-var">PFalse</span></a></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span id="local-6989586621679093124"><span class="annot"><a href="Propositions.html#isPTrue"><span class="hs-identifier hs-type">isPTrue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093124"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-80"></span><span id="isPTrue"><span class="annot"><span class="annottext">isPTrue :: PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#isPTrue"><span class="hs-identifier hs-var hs-var">isPTrue</span></a></span></span><span> </span><span class="annot"><a href="Propositions.html#PTrue"><span class="hs-identifier hs-type">PTrue</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-81"></span><span class="annot"><a href="Propositions.html#isPTrue"><span class="hs-identifier hs-var">isPTrue</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span id="local-6989586621679093256"><span class="annot"><a href="Propositions.html#isPFalse"><span class="hs-identifier hs-type">isPFalse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093256"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-84"></span><span id="isPFalse"><span class="annot"><span class="annottext">isPFalse :: PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#isPFalse"><span class="hs-identifier hs-var hs-var">isPFalse</span></a></span></span><span> </span><span class="annot"><a href="Propositions.html#PFalse"><span class="hs-identifier hs-type">PFalse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-85"></span><span class="annot"><a href="Propositions.html#isPFalse"><span class="hs-identifier hs-var">isPFalse</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span id="local-6989586621679093123"><span class="annot"><a href="Propositions.html#isLiteral"><span class="hs-identifier hs-type">isLiteral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093123"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-88"></span><span id="isLiteral"><span class="annot"><span class="annottext">isLiteral :: PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#isLiteral"><span class="hs-identifier hs-var hs-var">isLiteral</span></a></span></span><span> </span><span class="annot"><a href="Propositions.html#PTrue"><span class="hs-identifier hs-type">PTrue</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-89"></span><span class="annot"><a href="Propositions.html#isLiteral"><span class="hs-identifier hs-var">isLiteral</span></a></span><span> </span><span class="annot"><a href="Propositions.html#PFalse"><span class="hs-identifier hs-type">PFalse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-90"></span><span class="annot"><a href="Propositions.html#isLiteral"><span class="hs-identifier hs-var">isLiteral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PVariable"><span class="hs-identifier hs-type">PVariable</span></a></span><span> </span><span id="local-6989586621679093121"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679093121"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-91"></span><span class="annot"><a href="Propositions.html#isLiteral"><span class="hs-identifier hs-var">isLiteral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PNot"><span class="hs-identifier hs-type">PNot</span></a></span><span> </span><span id="local-6989586621679093120"><span class="annot"><span class="annottext">f :: PropositionalFormula a
</span><a href="#local-6989586621679093120"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; Bool
forall a. PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#isLiteral"><span class="hs-identifier hs-var">isLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093120"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-92"></span><span class="annot"><a href="Propositions.html#isLiteral"><span class="hs-identifier hs-var">isLiteral</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span id="local-6989586621679093119"><span class="annot"><a href="Propositions.html#isCNF"><span class="hs-identifier hs-type">isCNF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093119"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-95"></span><span id="isCNF"><span class="annot"><span class="annottext">isCNF :: PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#isCNF"><span class="hs-identifier hs-var hs-var">isCNF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PAnd"><span class="hs-identifier hs-type">PAnd</span></a></span><span> </span><span id="local-6989586621679093117"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679093117"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; Bool)
-&gt; [PropositionalFormula a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; Bool
forall a. PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#isCNF"><span class="hs-identifier hs-var">isCNF</span></a></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093117"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-96"></span><span class="annot"><a href="Propositions.html#isCNF"><span class="hs-identifier hs-var">isCNF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679093115"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679093115"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; Bool)
-&gt; [PropositionalFormula a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; Bool
forall a. PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#isLiteral"><span class="hs-identifier hs-var">isLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093115"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Propositions.html#isCNF"><span class="hs-identifier hs-var">isCNF</span></a></span><span> </span><span id="local-6989586621679093114"><span class="annot"><span class="annottext">p :: PropositionalFormula a
</span><a href="#local-6989586621679093114"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; Bool
forall a. PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#isLiteral"><span class="hs-identifier hs-var">isLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093114"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span id="local-6989586621679093113"><span class="annot"><a href="Propositions.html#toCNF"><span class="hs-identifier hs-type">toCNF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093113"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093113"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-100"></span><span id="toCNF"><span class="annot"><span class="annottext">toCNF :: PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#toCNF"><span class="hs-identifier hs-var hs-var">toCNF</span></a></span></span><span> </span><span id="local-6989586621679093111"><span class="annot"><span class="annottext">n :: PropositionalFormula a
</span><a href="#local-6989586621679093111"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PNot"><span class="hs-identifier hs-type">PNot</span></a></span><span> </span><span id="local-6989586621679093110"><span class="annot"><span class="annottext">a :: PropositionalFormula a
</span><a href="#local-6989586621679093110"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093110"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><a href="Propositions.html#PTrue"><span class="hs-identifier hs-type">PTrue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PFalse"><span class="hs-identifier hs-var">PFalse</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><a href="Propositions.html#PFalse"><span class="hs-identifier hs-type">PFalse</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PTrue"><span class="hs-identifier hs-var">PTrue</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PVariable"><span class="hs-identifier hs-type">PVariable</span></a></span><span> </span><span id="local-6989586621679093109"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679093109"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093111"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PNot"><span class="hs-identifier hs-type">PNot</span></a></span><span> </span><span id="local-6989586621679093108"><span class="annot"><span class="annottext">x :: PropositionalFormula a
</span><a href="#local-6989586621679093108"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#toCNF"><span class="hs-identifier hs-var">toCNF</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093108"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PAnd"><span class="hs-identifier hs-type">PAnd</span></a></span><span> </span><span id="local-6989586621679093107"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679093107"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#toCNF"><span class="hs-identifier hs-var">toCNF</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a] -&gt; PropositionalFormula a
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#POr"><span class="hs-identifier hs-var">POr</span></a></span><span> </span><span class="annot"><span class="annottext">([PropositionalFormula a] -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall l. Logic l =&gt; l -&gt; l
</span><a href="Logic.html#lnot"><span class="hs-identifier hs-var">lnot</span></a></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093107"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679093106"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679093106"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#toCNF"><span class="hs-identifier hs-var">toCNF</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a] -&gt; PropositionalFormula a
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#PAnd"><span class="hs-identifier hs-var">PAnd</span></a></span><span> </span><span class="annot"><span class="annottext">([PropositionalFormula a] -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall l. Logic l =&gt; l -&gt; l
</span><a href="Logic.html#lnot"><span class="hs-identifier hs-var">lnot</span></a></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093106"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-107"></span><span class="annot"><a href="Propositions.html#toCNF"><span class="hs-identifier hs-var">toCNF</span></a></span><span> </span><span id="local-6989586621679093105"><span class="annot"><span class="annottext">a :: PropositionalFormula a
</span><a href="#local-6989586621679093105"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PAnd"><span class="hs-identifier hs-type">PAnd</span></a></span><span> </span><span id="local-6989586621679093104"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679093104"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#simplify"><span class="hs-identifier hs-var">simplify</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a] -&gt; PropositionalFormula a
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#PAnd"><span class="hs-identifier hs-var">PAnd</span></a></span><span> </span><span class="annot"><span class="annottext">([PropositionalFormula a] -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#toCNF"><span class="hs-identifier hs-var">toCNF</span></a></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093104"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-108"></span><span class="annot"><a href="Propositions.html#toCNF"><span class="hs-identifier hs-var">toCNF</span></a></span><span> </span><span id="local-6989586621679093102"><span class="annot"><span class="annottext">o :: PropositionalFormula a
</span><a href="#local-6989586621679093102"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679093101"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679093101"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#simplify"><span class="hs-identifier hs-var">simplify</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; PropositionalFormula a -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a] -&gt; PropositionalFormula a
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#PAnd"><span class="hs-identifier hs-var">PAnd</span></a></span><span> </span><span class="annot"><span class="annottext">([PropositionalFormula a] -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([PropositionalFormula a]
 -&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a])
-&gt; [PropositionalFormula a]
-&gt; [[PropositionalFormula a]]
-&gt; [PropositionalFormula a]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall a.
[PropositionalFormula a]
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
</span><a href="Propositions.html#cartesianOr"><span class="hs-identifier hs-var">cartesianOr</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PFalse"><span class="hs-identifier hs-var">PFalse</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([[PropositionalFormula a]] -&gt; [PropositionalFormula a])
-&gt; [[PropositionalFormula a]] -&gt; [PropositionalFormula a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; [PropositionalFormula a])
-&gt; [PropositionalFormula a] -&gt; [[PropositionalFormula a]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; [PropositionalFormula a]
forall a. PropositionalFormula a -&gt; [PropositionalFormula a]
</span><a href="Propositions.html#toCNFClauseList"><span class="hs-identifier hs-var">toCNFClauseList</span></a></span><span> </span><span class="annot"><span class="annottext">([PropositionalFormula a] -&gt; [[PropositionalFormula a]])
-&gt; [PropositionalFormula a] -&gt; [[PropositionalFormula a]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#toCNF"><span class="hs-identifier hs-var">toCNF</span></a></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093101"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-comment">-- TODO</span><span>
</span><span id="line-109"></span><span class="annot"><a href="Propositions.html#toCNF"><span class="hs-identifier hs-var">toCNF</span></a></span><span> </span><span id="local-6989586621679093097"><span class="annot"><span class="annottext">p :: PropositionalFormula a
</span><a href="#local-6989586621679093097"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093097"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span id="local-6989586621679093096"><span class="annot"><a href="Propositions.html#lazyToCNF"><span class="hs-identifier hs-type">lazyToCNF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093096"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093096"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-112"></span><span id="lazyToCNF"><span class="annot"><span class="annottext">lazyToCNF :: PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#lazyToCNF"><span class="hs-identifier hs-var hs-var">lazyToCNF</span></a></span></span><span> </span><span id="local-6989586621679093094"><span class="annot"><span class="annottext">p :: PropositionalFormula a
</span><a href="#local-6989586621679093094"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; Bool
forall a. PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#isCNF"><span class="hs-identifier hs-var">isCNF</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093094"><span class="hs-identifier hs-var">p</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093094"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#toCNF"><span class="hs-identifier hs-var">toCNF</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093094"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">{-
Assumes that the given formula is in CNF.
Gives a list of the CNF's clauses.
The original formula can be reconstructed with PAnd (toClauseList x).
-}</span><span>
</span><span id="line-121"></span><span id="local-6989586621679093231"><span class="annot"><a href="Propositions.html#toCNFClauseList"><span class="hs-identifier hs-type">toCNFClauseList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093231"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093231"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-122"></span><span id="toCNFClauseList"><span class="annot"><span class="annottext">toCNFClauseList :: PropositionalFormula a -&gt; [PropositionalFormula a]
</span><a href="Propositions.html#toCNFClauseList"><span class="hs-identifier hs-var hs-var">toCNFClauseList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PAnd"><span class="hs-identifier hs-type">PAnd</span></a></span><span> </span><span id="local-6989586621679093093"><span class="annot"><span class="annottext">cs' :: [PropositionalFormula a]
</span><a href="#local-6989586621679093093"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093093"><span class="hs-identifier hs-var">cs'</span></a></span><span>
</span><span id="line-123"></span><span class="annot"><a href="Propositions.html#toCNFClauseList"><span class="hs-identifier hs-var">toCNFClauseList</span></a></span><span> </span><span id="local-6989586621679093092"><span class="annot"><span class="annottext">p :: PropositionalFormula a
</span><a href="#local-6989586621679093092"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093092"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span id="local-6989586621679093091"><span class="annot"><a href="Propositions.html#toDNFClauseList"><span class="hs-identifier hs-type">toDNFClauseList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093091"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093091"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-126"></span><span id="toDNFClauseList"><span class="annot"><span class="annottext">toDNFClauseList :: PropositionalFormula a -&gt; [PropositionalFormula a]
</span><a href="Propositions.html#toDNFClauseList"><span class="hs-identifier hs-var hs-var">toDNFClauseList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679093089"><span class="annot"><span class="annottext">cs' :: [PropositionalFormula a]
</span><a href="#local-6989586621679093089"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093089"><span class="hs-identifier hs-var">cs'</span></a></span><span>
</span><span id="line-127"></span><span class="annot"><a href="Propositions.html#toDNFClauseList"><span class="hs-identifier hs-var">toDNFClauseList</span></a></span><span> </span><span id="local-6989586621679093088"><span class="annot"><span class="annottext">p :: PropositionalFormula a
</span><a href="#local-6989586621679093088"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093088"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span id="local-6989586621679093087"><span class="annot"><a href="Propositions.html#toNNF"><span class="hs-identifier hs-type">toNNF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093087"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093087"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-130"></span><span id="toNNF"><span class="annot"><span class="annottext">toNNF :: PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#toNNF"><span class="hs-identifier hs-var hs-var">toNNF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PNot"><span class="hs-identifier hs-type">PNot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679093085"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679093085"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a] -&gt; PropositionalFormula a
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#PAnd"><span class="hs-identifier hs-var">PAnd</span></a></span><span> </span><span class="annot"><span class="annottext">([PropositionalFormula a] -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#toNNF"><span class="hs-identifier hs-var">toNNF</span></a></span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; (PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; PropositionalFormula a
-&gt; PropositionalFormula a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#PNot"><span class="hs-identifier hs-var">PNot</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093085"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-131"></span><span class="annot"><a href="Propositions.html#toNNF"><span class="hs-identifier hs-var">toNNF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PNot"><span class="hs-identifier hs-type">PNot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PAnd"><span class="hs-identifier hs-type">PAnd</span></a></span><span> </span><span id="local-6989586621679093083"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679093083"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a] -&gt; PropositionalFormula a
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#POr"><span class="hs-identifier hs-var">POr</span></a></span><span> </span><span class="annot"><span class="annottext">([PropositionalFormula a] -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#toNNF"><span class="hs-identifier hs-var">toNNF</span></a></span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; (PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; PropositionalFormula a
-&gt; PropositionalFormula a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#PNot"><span class="hs-identifier hs-var">PNot</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093083"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-132"></span><span class="annot"><a href="Propositions.html#toNNF"><span class="hs-identifier hs-var">toNNF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PNot"><span class="hs-identifier hs-type">PNot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PNot"><span class="hs-identifier hs-type">PNot</span></a></span><span> </span><span id="local-6989586621679093082"><span class="annot"><span class="annottext">x :: PropositionalFormula a
</span><a href="#local-6989586621679093082"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#toNNF"><span class="hs-identifier hs-var">toNNF</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093082"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-133"></span><span class="annot"><a href="Propositions.html#toNNF"><span class="hs-identifier hs-var">toNNF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679093081"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679093081"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a] -&gt; PropositionalFormula a
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#POr"><span class="hs-identifier hs-var">POr</span></a></span><span> </span><span class="annot"><span class="annottext">([PropositionalFormula a] -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#toNNF"><span class="hs-identifier hs-var">toNNF</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093081"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-134"></span><span class="annot"><a href="Propositions.html#toNNF"><span class="hs-identifier hs-var">toNNF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PAnd"><span class="hs-identifier hs-type">PAnd</span></a></span><span> </span><span id="local-6989586621679093080"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679093080"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a] -&gt; PropositionalFormula a
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#PAnd"><span class="hs-identifier hs-var">PAnd</span></a></span><span> </span><span class="annot"><span class="annottext">([PropositionalFormula a] -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; PropositionalFormula a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#toNNF"><span class="hs-identifier hs-var">toNNF</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093080"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-135"></span><span class="annot"><a href="Propositions.html#toNNF"><span class="hs-identifier hs-var">toNNF</span></a></span><span> </span><span id="local-6989586621679093079"><span class="annot"><span class="annottext">p :: PropositionalFormula a
</span><a href="#local-6989586621679093079"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093079"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">{-
Returns a list of disjunctions such that all possible combinations of the formulas in the input lists are considered.
Like the cartesian product but instead of pairs (x, y) we produce POr [x, y].
-}</span><span>
</span><span id="line-141"></span><span id="local-6989586621679093232"><span class="annot"><a href="Propositions.html#cartesianOr"><span class="hs-identifier hs-type">cartesianOr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093232"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093232"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093232"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-142"></span><span id="cartesianOr"><span class="annot"><span class="annottext">cartesianOr :: [PropositionalFormula a]
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
</span><a href="Propositions.html#cartesianOr"><span class="hs-identifier hs-var hs-var">cartesianOr</span></a></span></span><span> </span><span id="local-6989586621679093078"><span class="annot"><span class="annottext">l1 :: [PropositionalFormula a]
</span><a href="#local-6989586621679093078"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span id="local-6989586621679093077"><span class="annot"><span class="annottext">l2 :: [PropositionalFormula a]
</span><a href="#local-6989586621679093077"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[PropositionalFormula a] -&gt; PropositionalFormula a
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#POr"><span class="hs-identifier hs-var">POr</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093076"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093075"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679093076"><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093076"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093078"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679093075"><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093075"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093077"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span id="local-6989586621679093074"><span class="annot"><a href="Propositions.html#simplify"><span class="hs-identifier hs-type">simplify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093074"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093074"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-145"></span><span id="simplify"><span class="annot"><span class="annottext">simplify :: PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#simplify"><span class="hs-identifier hs-var hs-var">simplify</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PNot"><span class="hs-identifier hs-type">PNot</span></a></span><span> </span><span id="local-6989586621679093073"><span class="annot"><span class="annottext">a :: PropositionalFormula a
</span><a href="#local-6989586621679093073"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#simplify"><span class="hs-identifier hs-var">simplify</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093073"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><a href="Propositions.html#PTrue"><span class="hs-identifier hs-type">PTrue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PFalse"><span class="hs-identifier hs-var">PFalse</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><a href="Propositions.html#PFalse"><span class="hs-identifier hs-type">PFalse</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PTrue"><span class="hs-identifier hs-var">PTrue</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PNot"><span class="hs-identifier hs-type">PNot</span></a></span><span> </span><span id="local-6989586621679093072"><span class="annot"><span class="annottext">x :: PropositionalFormula a
</span><a href="#local-6989586621679093072"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093072"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span id="local-6989586621679093071"><span class="annot"><span class="annottext">p :: PropositionalFormula a
</span><a href="#local-6989586621679093071"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#PNot"><span class="hs-identifier hs-var">PNot</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093071"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-150"></span><span class="annot"><a href="Propositions.html#simplify"><span class="hs-identifier hs-var">simplify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PAnd"><span class="hs-identifier hs-type">PAnd</span></a></span><span> </span><span id="local-6989586621679093070"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679093070"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; Bool)
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; (PropositionalFormula a -&gt; Bool)
-&gt; PropositionalFormula a
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; Bool
forall a. PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#isPTrue"><span class="hs-identifier hs-var">isPTrue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Filter all Trues</span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><span class="annottext">([PropositionalFormula a] -&gt; [PropositionalFormula a])
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[PropositionalFormula a]] -&gt; [PropositionalFormula a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[PropositionalFormula a]] -&gt; [PropositionalFormula a])
-&gt; [[PropositionalFormula a]] -&gt; [PropositionalFormula a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; [PropositionalFormula a])
-&gt; [PropositionalFormula a] -&gt; [[PropositionalFormula a]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; [PropositionalFormula a]
forall a. PropositionalFormula a -&gt; [PropositionalFormula a]
</span><a href="Propositions.html#toCNFClauseList"><span class="hs-identifier hs-var">toCNFClauseList</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; [PropositionalFormula a])
-&gt; (PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; PropositionalFormula a
-&gt; [PropositionalFormula a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#simplify"><span class="hs-identifier hs-var">simplify</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093070"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-comment">-- simplify all children and flatten the formula</span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-keyword">of</span><span>
</span><span id="line-154"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PTrue"><span class="hs-identifier hs-var">PTrue</span></a></span><span>
</span><span id="line-155"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679093068"><span class="annot"><span class="annottext">p :: PropositionalFormula a
</span><a href="#local-6989586621679093068"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093068"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-156"></span><span>        </span><span id="local-6989586621679093067"><span class="annot"><span class="annottext">clauses :: [PropositionalFormula a]
</span><a href="#local-6989586621679093067"><span class="hs-identifier hs-var">clauses</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; Bool)
-&gt; [PropositionalFormula a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; Bool
forall a. PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#isPFalse"><span class="hs-identifier hs-var">isPFalse</span></a></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093067"><span class="hs-identifier hs-var">clauses</span></a></span><span> </span><span class="hs-comment">-- If any value in a disjunction is false, the disjunction becomes false.</span><span>
</span><span id="line-157"></span><span>                   </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PFalse"><span class="hs-identifier hs-var">PFalse</span></a></span><span>
</span><span id="line-158"></span><span>                   </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a] -&gt; PropositionalFormula a
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#PAnd"><span class="hs-identifier hs-var">PAnd</span></a></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093067"><span class="hs-identifier hs-var">clauses</span></a></span><span>
</span><span id="line-159"></span><span class="annot"><a href="Propositions.html#simplify"><span class="hs-identifier hs-var">simplify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679093066"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679093066"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; Bool)
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; (PropositionalFormula a -&gt; Bool)
-&gt; PropositionalFormula a
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; Bool
forall a. PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#isPFalse"><span class="hs-identifier hs-var">isPFalse</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Filter all Falses</span><span>
</span><span id="line-161"></span><span>    </span><span class="annot"><span class="annottext">([PropositionalFormula a] -&gt; [PropositionalFormula a])
-&gt; [PropositionalFormula a] -&gt; [PropositionalFormula a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[PropositionalFormula a]] -&gt; [PropositionalFormula a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[PropositionalFormula a]] -&gt; [PropositionalFormula a])
-&gt; [[PropositionalFormula a]] -&gt; [PropositionalFormula a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; [PropositionalFormula a])
-&gt; [PropositionalFormula a] -&gt; [[PropositionalFormula a]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; [PropositionalFormula a]
forall a. PropositionalFormula a -&gt; [PropositionalFormula a]
</span><a href="Propositions.html#toDNFClauseList"><span class="hs-identifier hs-var">toDNFClauseList</span></a></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; [PropositionalFormula a])
-&gt; (PropositionalFormula a -&gt; PropositionalFormula a)
-&gt; PropositionalFormula a
-&gt; [PropositionalFormula a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; PropositionalFormula a
forall a. PropositionalFormula a -&gt; PropositionalFormula a
</span><a href="Propositions.html#simplify"><span class="hs-identifier hs-var">simplify</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093066"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-comment">-- simplify all children and flatten the formula</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-keyword">of</span><span>
</span><span id="line-163"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PFalse"><span class="hs-identifier hs-var">PFalse</span></a></span><span>
</span><span id="line-164"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679093065"><span class="annot"><span class="annottext">p :: PropositionalFormula a
</span><a href="#local-6989586621679093065"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093065"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-165"></span><span>        </span><span id="local-6989586621679093064"><span class="annot"><span class="annottext">clauses :: [PropositionalFormula a]
</span><a href="#local-6989586621679093064"><span class="hs-identifier hs-var">clauses</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; Bool)
-&gt; [PropositionalFormula a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; Bool
forall a. PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#isPTrue"><span class="hs-identifier hs-var">isPTrue</span></a></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093064"><span class="hs-identifier hs-var">clauses</span></a></span><span> </span><span class="hs-comment">-- If any value in a disjunction is true, the disjunction becomes true.</span><span>
</span><span id="line-166"></span><span>                   </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
forall a. PropositionalFormula a
</span><a href="Propositions.html#PTrue"><span class="hs-identifier hs-var">PTrue</span></a></span><span>
</span><span id="line-167"></span><span>                   </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a] -&gt; PropositionalFormula a
forall a. [PropositionalFormula a] -&gt; PropositionalFormula a
</span><a href="Propositions.html#POr"><span class="hs-identifier hs-var">POr</span></a></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093064"><span class="hs-identifier hs-var">clauses</span></a></span><span>
</span><span id="line-168"></span><span class="annot"><a href="Propositions.html#simplify"><span class="hs-identifier hs-var">simplify</span></a></span><span> </span><span id="local-6989586621679093063"><span class="annot"><span class="annottext">p :: PropositionalFormula a
</span><a href="#local-6989586621679093063"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093063"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">{-
Assumes that the given formula is in CNF.
The first argument is a functions resolving negation, i.e. it should take an 'a' and give its negated version.
The second argument is a function creating the value of type a that should be associated with 'false' (PFalse).
For example, 0 could represent False in propositional formulas over numerals.
(Note, if no such value exists, the 'false' function is free to produce an error.)
The third argument is the function in CNF that should be clausified.
If still confused, try the following call and look at the result:
    show $ clausifyCNF (\x -&gt; &quot;not &quot;++x) &quot;false&quot; (toCNF p)
where p is a propositional formula over strings.
-}</span><span>
</span><span id="line-181"></span><span id="local-6989586621679093212"><span class="annot"><a href="Propositions.html#clausifyCNF"><span class="hs-identifier hs-type">clausifyCNF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679093212"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679093212"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679093212"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679093212"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093212"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679093212"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-182"></span><span id="clausifyCNF"><span class="annot"><span class="annottext">clausifyCNF :: (a -&gt; a) -&gt; (() -&gt; a) -&gt; PropositionalFormula a -&gt; [[a]]
</span><a href="Propositions.html#clausifyCNF"><span class="hs-identifier hs-var hs-var">clausifyCNF</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><a href="Propositions.html#PTrue"><span class="hs-identifier hs-type">PTrue</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-183"></span><span class="annot"><a href="Propositions.html#clausifyCNF"><span class="hs-identifier hs-var">clausifyCNF</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679093061"><span class="annot"><span class="annottext">false :: () -&gt; a
</span><a href="#local-6989586621679093061"><span class="hs-identifier hs-var">false</span></a></span></span><span> </span><span class="annot"><a href="Propositions.html#PFalse"><span class="hs-identifier hs-type">PFalse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">() -&gt; a
</span><a href="#local-6989586621679093061"><span class="hs-identifier hs-var">false</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-comment">--error &quot;PFalse cannot be clausifed.&quot;</span><span>
</span><span id="line-184"></span><span class="annot"><a href="Propositions.html#clausifyCNF"><span class="hs-identifier hs-var">clausifyCNF</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PVariable"><span class="hs-identifier hs-type">PVariable</span></a></span><span> </span><span id="local-6989586621679093060"><span class="annot"><span class="annottext">v :: a
</span><a href="#local-6989586621679093060"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679093060"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span class="annot"><a href="Propositions.html#clausifyCNF"><span class="hs-identifier hs-var">clausifyCNF</span></a></span><span> </span><span id="local-6989586621679093059"><span class="annot"><span class="annottext">negator :: a -&gt; a
</span><a href="#local-6989586621679093059"><span class="hs-identifier hs-var">negator</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679093058"><span class="annot"><span class="annottext">n :: PropositionalFormula a
</span><a href="#local-6989586621679093058"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PNot"><span class="hs-identifier hs-type">PNot</span></a></span><span> </span><span id="local-6989586621679093057"><span class="annot"><span class="annottext">p :: PropositionalFormula a
</span><a href="#local-6989586621679093057"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093057"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><a href="Propositions.html#PVariable"><span class="hs-identifier hs-type">PVariable</span></a></span><span> </span><span id="local-6989586621679093056"><span class="annot"><span class="annottext">v :: a
</span><a href="#local-6989586621679093056"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679093059"><span class="hs-identifier hs-var">negator</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679093056"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[a]]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [[a]]) -&gt; [Char] -&gt; [[a]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Given formula &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093058"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="hs-string">&quot; not in CNF!&quot;</span></span><span>
</span><span id="line-188"></span><span class="annot"><a href="Propositions.html#clausifyCNF"><span class="hs-identifier hs-var">clausifyCNF</span></a></span><span> </span><span id="local-6989586621679093053"><span class="annot"><span class="annottext">negator :: a -&gt; a
</span><a href="#local-6989586621679093053"><span class="hs-identifier hs-var">negator</span></a></span></span><span> </span><span id="local-6989586621679093052"><span class="annot"><span class="annottext">false :: () -&gt; a
</span><a href="#local-6989586621679093052"><span class="hs-identifier hs-var">false</span></a></span></span><span> </span><span id="local-6989586621679093051"><span class="annot"><span class="annottext">and :: PropositionalFormula a
</span><a href="#local-6989586621679093051"><span class="hs-identifier hs-var">and</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PAnd"><span class="hs-identifier hs-type">PAnd</span></a></span><span> </span><span id="local-6989586621679093050"><span class="annot"><span class="annottext">clauses :: [PropositionalFormula a]
</span><a href="#local-6989586621679093050"><span class="hs-identifier hs-var">clauses</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; Bool
forall a. PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#isCNF"><span class="hs-identifier hs-var">isCNF</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093051"><span class="hs-identifier hs-var">and</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[[[a]]] -&gt; [[a]]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[[a]]] -&gt; [[a]]) -&gt; [[[a]]] -&gt; [[a]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; [[a]])
-&gt; [PropositionalFormula a] -&gt; [[[a]]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; (() -&gt; a) -&gt; PropositionalFormula a -&gt; [[a]]
forall a.
Show a =&gt;
(a -&gt; a) -&gt; (() -&gt; a) -&gt; PropositionalFormula a -&gt; [[a]]
</span><a href="Propositions.html#clausifyCNF"><span class="hs-identifier hs-var">clausifyCNF</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679093053"><span class="hs-identifier hs-var">negator</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; a
</span><a href="#local-6989586621679093052"><span class="hs-identifier hs-var">false</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093050"><span class="hs-identifier hs-var">clauses</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[a]]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [[a]]) -&gt; [Char] -&gt; [[a]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Given formula &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093051"><span class="hs-identifier hs-var">and</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="hs-string">&quot; not in CNF!&quot;</span></span><span>
</span><span id="line-191"></span><span class="annot"><a href="Propositions.html#clausifyCNF"><span class="hs-identifier hs-var">clausifyCNF</span></a></span><span> </span><span id="local-6989586621679093049"><span class="annot"><span class="annottext">negator :: a -&gt; a
</span><a href="#local-6989586621679093049"><span class="hs-identifier hs-var">negator</span></a></span></span><span> </span><span id="local-6989586621679093048"><span class="annot"><span class="annottext">false :: () -&gt; a
</span><a href="#local-6989586621679093048"><span class="hs-identifier hs-var">false</span></a></span></span><span> </span><span id="local-6989586621679093047"><span class="annot"><span class="annottext">or :: PropositionalFormula a
</span><a href="#local-6989586621679093047"><span class="hs-identifier hs-var">or</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679093046"><span class="annot"><span class="annottext">literals :: [PropositionalFormula a]
</span><a href="#local-6989586621679093046"><span class="hs-identifier hs-var">literals</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; Bool
forall a. PropositionalFormula a -&gt; Bool
</span><a href="Propositions.html#isCNF"><span class="hs-identifier hs-var">isCNF</span></a></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093047"><span class="hs-identifier hs-var">or</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[[a]] -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[a]] -&gt; [a]) -&gt; [[a]] -&gt; [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[[a]]] -&gt; [[a]]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[[a]]] -&gt; [[a]]) -&gt; [[[a]]] -&gt; [[a]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; [[a]])
-&gt; [PropositionalFormula a] -&gt; [[[a]]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; (() -&gt; a) -&gt; PropositionalFormula a -&gt; [[a]]
forall a.
Show a =&gt;
(a -&gt; a) -&gt; (() -&gt; a) -&gt; PropositionalFormula a -&gt; [[a]]
</span><a href="Propositions.html#clausifyCNF"><span class="hs-identifier hs-var">clausifyCNF</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679093049"><span class="hs-identifier hs-var">negator</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; a
</span><a href="#local-6989586621679093048"><span class="hs-identifier hs-var">false</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093046"><span class="hs-identifier hs-var">literals</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[a]]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [[a]]) -&gt; [Char] -&gt; [[a]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Given formula &quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093047"><span class="hs-identifier hs-var">or</span></a></span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="hs-string">&quot; not in CNF!&quot;</span></span><span>
</span><span id="line-194"></span><span>                            </span><span>
</span><span id="line-195"></span><span class="hs-comment">-- -- Default ASCII expressions</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- instance Show a =&gt; Show (PropositionalFormula a) where</span><span>
</span><span id="line-197"></span><span class="hs-comment">--     show PTrue = &quot;T&quot;</span><span>
</span><span id="line-198"></span><span class="hs-comment">--     show PFalse = &quot;F&quot;</span><span>
</span><span id="line-199"></span><span class="hs-comment">--     show (PVariable v) = show v</span><span>
</span><span id="line-200"></span><span class="hs-comment">--     show (PNot p) = &quot;&#172;&quot;++show p</span><span>
</span><span id="line-201"></span><span class="hs-comment">--     show (PAnd cs) = parenIf (length cs &gt; 1) (intercalate &quot; ^ &quot; $ map show cs)</span><span>
</span><span id="line-202"></span><span class="hs-comment">--     show (POr cs) = parenIf (length cs &gt; 1) (intercalate &quot; v &quot; $ map show cs)</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- Nice UTF8 styled expressions</span><span>
</span><span id="line-205"></span><span id="local-6989586621679093045"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679093040"><span id="local-6989586621679093043"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679093045"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PropositionalFormula"><span class="hs-identifier hs-type">PropositionalFormula</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093045"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-206"></span><span>    </span><span id="local-6989586621679093038"><span class="annot"><span class="annottext">show :: PropositionalFormula a -&gt; [Char]
</span><a href="#local-6989586621679093038"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="annot"><a href="Propositions.html#PTrue"><span class="hs-identifier hs-type">PTrue</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;&#8868;&quot;</span></span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><a href="Propositions.html#PFalse"><span class="hs-identifier hs-type">PFalse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;&#8869;&quot;</span></span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PVariable"><span class="hs-identifier hs-type">PVariable</span></a></span><span> </span><span id="local-6989586621679093037"><span class="annot"><span class="annottext">v :: a
</span><a href="#local-6989586621679093037"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679093037"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PNot"><span class="hs-identifier hs-type">PNot</span></a></span><span> </span><span id="local-6989586621679093036"><span class="annot"><span class="annottext">p :: PropositionalFormula a
</span><a href="#local-6989586621679093036"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;&#172;&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a
</span><a href="#local-6989586621679093036"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#PAnd"><span class="hs-identifier hs-type">PAnd</span></a></span><span> </span><span id="local-6989586621679093035"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679093035"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [Char]
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="hs-string">&quot; &#8743; &quot;</span></span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [Char]) -&gt; [[Char]] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; [Char])
-&gt; [PropositionalFormula a] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093035"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Propositions.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679093034"><span class="annot"><span class="annottext">cs :: [PropositionalFormula a]
</span><a href="#local-6989586621679093034"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;(&quot;</span></span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [Char]
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="hs-string">&quot; &#8744; &quot;</span></span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [Char]) -&gt; [[Char]] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PropositionalFormula a -&gt; [Char])
-&gt; [PropositionalFormula a] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PropositionalFormula a -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[PropositionalFormula a]
</span><a href="#local-6989586621679093034"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="hs-string">&quot;)&quot;</span></span></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">-- -- This visualisation is for debugging as it shows the exact expression tree.</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- instance Show a =&gt; Show (PropositionalFormula a) where</span><span>
</span><span id="line-215"></span><span class="hs-comment">--     show PTrue = &quot;(PTrue)&quot;</span><span>
</span><span id="line-216"></span><span class="hs-comment">--     show PFalse = &quot;(PFalse)&quot;</span><span>
</span><span id="line-217"></span><span class="hs-comment">--     show (PVariable v) = &quot;(PVariable &quot;++show v++&quot;)&quot;</span><span>
</span><span id="line-218"></span><span class="hs-comment">--     show (PNot p) = &quot;(PNot &quot;++show p++&quot;)&quot;</span><span>
</span><span id="line-219"></span><span class="hs-comment">--     show (PAnd cs) = &quot;(PAnd [&quot;++(intercalate &quot;, &quot; $ map show cs)++&quot;])&quot;</span><span>
</span><span id="line-220"></span><span class="hs-comment">--     show (POr cs) = &quot;(POr [&quot;++(intercalate &quot;, &quot; $ map show cs)++&quot;])&quot;</span><span>
</span><span id="line-221"></span></pre></body></html>